<!DOCTYPE html>
<html>
	<!--
		************************************
			Author: Joel Garcia
		************************************
			Notes: This tool makes use of open source libraries such as:
				ReactJS[react & react-dom]
				Babel
				jquery
				jquery-ui
				FileSaver
				SheetJS xlsx.core
	-->
  <head>
	<link rel="icon" type="image/png" href="/faviconn.png" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
 	<style>
		 

	</style>
    <meta charset="UTF-8" />
    <title>OR Dashboard</title>

	<link rel="stylesheet" href="css/jquery-ui.css"/> <!-- https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css -->
	<link rel="stylesheet" href="css/css.css"/>

	<script src="js/react.development.js"></script> <!-- https://unpkg.com/react@16/umd/react.development.js -->
	<script src="js/react-dom.development.js"></script> <!-- https://unpkg.com/react-dom@16/umd/react-dom.development.js -->

	<script src="js/6.15.0-babel.min.js"></script> <!-- https://unpkg.com/babel-standalone@6.15.0/babel.min.js -->

	<script src="js/jquery-1.12.4.js"></script> <!-- https://code.jquery.com/jquery-1.12.4.js -->
	<script src="js/1.12.1-jquery-ui.js"></script> <!-- https://code.jquery.com/ui/1.12.1/jquery-ui.js -->

	<script src="js/xlsx.full.min.js"></script>

	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	
  </head>
    <body>
	
    <div id="root"></div>

	

    <script type="text/babel">
    
    class App extends React.Component {
        
        constructor(props){
            super(props);
			this.state = {  osDropdownVal: "select",
							pageDropdownVal: "select",
							gitlabProjectName: "select",
							gitlabBranchName: "select",
							actionNameVal: "select",
							gitlabProjectsName: [],//"CIBP", "EBSS", "PAYS", "EBTS", "PCAS"
							gitlabListOfProjects: ["DevCIBP", "QACIBP", "PICS", "PAYS", "EBTS", "PCAS"],
							gitlabProjectID: [492, 961, 701, 743, 604, 750],
							gitlabDynamicProjectID: 0,
							projectBranches: [],
							OR: [],
							browserNames: [],
							browserPages: [],
							cases: [],
							pageNChilds: [],
							pagesDropdown: [],
							elements: [],
							filteredElements: [],
							globalFilteredElements: [],
							cases: [],				
							actions: ["Tap","RotateDevice", "SwitchContext", "ScrollDown", "SwipeDownwards","SwipeUpwards", "LongPress", "TapIfattributeIs", "Press", "SwitchFrame", "SelectElement", "OpenApp", "Input", "InputIfExists", "DoMathOperations", "CallTo", "Click", "ClickJS", "ClickIfExists", "Verify", "SelectByIndex", "InputIfExistsAndPressEnter", "InputDateOnCalendar", "ClickInsideTable", "ClickOnCheckboxInTable", "Hover", "GetValue", "GetText", "ClickIfCheckboxIsUnselected", "GetCheckboxState", "SwitchTab", "OpenNewTab", "CloseTab", "NavigateTo", "WaitFor", "SetTableRow", "SwipeUpwards", "SwipeDownwards", "Exit", "HandleAlert"],
							actionsss: [],
							aElementsWithErrors: [],
							searchFilterValue: "",
							filterByTypeValue: "",
							showSpinner: false,
							xmlReadDone: true,
                            sElementsFilter: "select",
                            os: [],
							aIosScreens: [],
							oIosScreenNObjects: [],
							aWebScreens: [],
							oWebScreenNObjects: [],
							aAndroidScreens: [],
							oAndroidScreenNObjects: [],
							oWebScreenNObjects: [],
							oOtherMobileScreenNObjects: [],
							aOtherMobileScreens: [],
							aGitlabtWebScreens: [],
							oGitlabWebScreenNObjects: [],
							aGitlabAndroidScreens: [],
							aGitlabIosScreens: [],
							bShowORImport: false,
							renderGitlabOptions: false,
							sourceOption: "Manual OR upload",
							sourcesOptions: ["Manual OR upload"],
							renderSourceOption: "manual",
							token: "private_token=y-cu6cTeV4QM_zquJpte",
							callToFeatures: [],
							globalFilter: false,
							globalSearchCheckbox: false,
							iORProgressCount: 0,
							aPagesDropdownCount: 0,
							aFailedObjects: [],
							allObjectsInProject: 0
							//repoID: 
                        };
            //this.constructWebElementHTML = this.constructWebElementHTML.bind(this);    
			         
			this.OSChange = this.OSChange.bind(this);
			this.pageChange = this.pageChange.bind(this);
			this.addCase = this.addCase.bind(this);
			this.delCase = this.delCase.bind(this);
			this.export = this.export.bind(this);
			this.handleFilterChange = this.handleFilterChange.bind(this);
			this.updateor = this.updateor.bind(this);
			this.showImportOptions = this.showImportOptions.bind(this);
			this.uploadORSheets = this.uploadORSheets.bind(this);
			this.gitlabProjectChange = this.gitlabProjectChange.bind(this);
			this.gitlabBranchChange = this.gitlabBranchChange.bind(this);
			this.createGitlabORStructure = this.createGitlabORStructure.bind(this);
			this.createGitlabORStructure2 = this.createGitlabORStructure2.bind(this);
			this.fetchBranchRepos = this.fetchBranchRepos.bind(this);
			this.fetchBranchReposCB = this.fetchBranchReposCB.bind(this);
			this.projectReset = this.projectReset.bind(this);
			this.branchReset = this.branchReset.bind(this);
			this.fetchGitlabProjectBranches = this.fetchGitlabProjectBranches.bind(this);
			this.chooseSource = this.chooseSource.bind(this);
			this.updateORObjectsInfo = this.updateORObjectsInfo.bind(this);
			this.fetchSubDirectories = this.fetchSubDirectories.bind(this);
			this.actionChange = this.actionChange.bind(this);
			this.toggleSelector = this.toggleSelector.bind(this);
			this.hideToggableElements = this.hideToggableElements.bind(this);
			this.getCallTo = this.getCallTo.bind(this);
			this.processFeaturesResponse = this.processFeaturesResponse.bind(this);
			this.fetchBranchFeatures = this.fetchBranchFeatures.bind(this);
			this.ShowCallToSteps = this.ShowCallToSteps.bind(this);
			this.renderCallToTable = this.renderCallToTable.bind(this);
			this.handleGlobalSearchCheckbox = this.handleGlobalSearchCheckbox.bind(this);
			this.changeInputSearchValue = this.changeInputSearchValue.bind(this);
			this.stopSpinner = this.stopSpinner.bind(this);
			this.orHealthyCheck = this.orHealthyCheck.bind(this);
			//this.handleByTextFilter = this.handleByTextFilter.bind(this);
			//this.handleByElementTypeChange = this.handleByElementTypeChange.bind(this);
        }


		///////////////////////////////////////////////////////////////////
		componentDidMount(){
			// this.setState({
			// 	//showSpinner: true
			// });

			// let sortedActions = this.state.actions.sort();
			// sortedActions.unshift("Select");

			// this.setState({
			// 	actions: sortedActions
			// });

			// var _this = this; // object pertaining to the <App /> component itself.
			// let sInputURL = window.location.href;
			
			// let aURLParameters = sInputURL.split("?app=");
			// let respositoryidParameters = sInputURL.split("?respositoryid=");
			// let repoID = respositoryidParameters[1];

			// if (false){//(aURLParameters.length != 2){
			// 	alert("Error: URL provided is incorrect. Please contact the developer for assitance.");
			// }
			// else if (respositoryidParameters.length == 2){
			// 	let projectNames = this.state.gitlabListOfProjects;	//: ["DevCIBP", "QACIBP", "PICS", "PAYS", "EBTS", "PCAS"],
			// 	let projectIDs = this.state.gitlabProjectID;		//: [492, 961, 701, 743, 604, 750],

				

			// 	let repoURL = "https://gitlab.evertecinc.com/api/v4/projects/" + repoID + "?private_token=y-cu6cTeV4QM_zquJpte";

			// 	//"https://gitlab.evertecinc.com/api/v4/projects/" + respositoryid
			// 	// get response.name
			// 	var xhttp = new XMLHttpRequest();
			// 	var _this = this;

			// 	var error = false;
			// 	var response; 
			// 	xhttp.onreadystatechange = function() {
			// 		if (this.readyState == 4 && this.status == 200){
			// 			//if() {
						
							
			// 				var response = JSON.parse(this.responseText);
						
			// 				projectIDs.push(repoID);
			// 				projectNames.push(response.name);

			// 				_this.setState({
			// 					gitlabProjectsName: [response.name],
			// 					gitlabListOfProjects: projectNames,
			// 					gitlabProjectID: projectIDs,
			// 					gitlabDynamicProjectID: repoID,
			// 					sourceOption: "Gitlab",
			// 					renderSourceOption: "gitlab"
			// 				})
			// 				//_this.processFeaturesResponse(response, url);
							
			// 		}
			// 		else {
			// 				//console.log(this.status);
			// 			error = true;
			// 			console.log("error in repoURL: " + repoURL);
			// 		}
			// 		//}
			// 		//else {
						
			// 		//}
					
			// 	};
			// 	xhttp.open("GET", repoURL, true);
			// 	xhttp.send();
			
			
				
			// }
			// else if (aURLParameters.length == 2){
			// 	let project;
			// 	let sApp = aURLParameters[1].toUpperCase();


			// 	switch (sApp) {

			// 		case "DEVCIBP":
			// 			project ="cibp";
			// 			this.setState({
			// 				gitlabProjectsName: ["DevCIBP"]
			// 			})
						
			// 			break;
			// 		case "QACIBP":
			// 			project ="cibp";
			// 			this.setState({
			// 				gitlabProjectsName: ["QACIBP"]
			// 			})
						
			// 			break;	
			// 		case "EBTS":
			// 			project ="ebts";
						
			// 			this.setState({
			// 				gitlabProjectsName: ["EBTS"]
			// 			})
			// 			break;
			// 		case "PAYS":
			// 			project ="pays";

			// 			this.setState({
			// 				gitlabProjectsName: ["PAYS"]
			// 			})
			// 			break;
			// 		case "PCAS":
			// 			project ="pcas";

			// 			this.setState({
			// 				gitlabProjectsName: ["PCAS"]
			// 			})
			// 			break;
			// 		case "EBSS":	
			// 		case "PICS":
			// 			project ="pics";

			// 			this.setState({
			// 				gitlabProjectsName: ["PICS"]
			// 			})
			// 			break;
			// 		default:
			// 			alert("app not found");
			// 	}
			// }
			
		}
		////////////////////////////////////////////////////////////
///===============
		showImportOptions(){
			document.querySelector(".import-container").style.display = "block";
		}
		
		
/////=================
		/* Delete Step from Feature File

		INPUT: HTML row object
		*/
		delCase = obj => {
			
			//console.log("cases:", this.state.cases);
			//console.log(obj);//obj.target.parentNode.rowIndex);
			//console.log(obj.target.parentNode.parentNode.parentNode.parentNode);
			//console.log(obj.target.parentNode.parentNode.rowIndex);
			//console.log(this.state.cases);

			let iClickedRow = obj.target.parentNode.parentNode.rowIndex;

			
			let oTableObj = obj.target.parentNode.parentNode.parentNode.parentNode;
				oTableObj.deleteRow(iClickedRow);
			
			let iRowToClick = iClickedRow - 2;
			let aFilteredCases = this.state.cases.filter((el, idx) => idx != iRowToClick);
			
			/*  ---- This sections was commented since it serves as a bypass to React's re-render -----
			//			The Table Row was deleted directly via DOM manipulation, thus we want React not to know about the Table change
				let casesFiltered = [];
				casesFiltered = this.state.cases.filter((oEvaluatedElement, index) => oEvaluatedElement.name !== oObjName);

				this.setState({
					cases: casesFiltered
				})
			*/
		}


		addCase = (objectInfo, pageFromGlobalSearch) => {
			
			let caseInfo = 	this.state.cases;

			let globalSearchCheckbox = this.state.globalSearchCheckbox;

			var obj = {};
			if (objectInfo == "placeholder-step"){
				//console.log("placeholder step added");


				obj.pageName = this.state.pageDropdownVal;
				obj.text = "placeholder-step";

				objectInfo = "placeholder-step";
				caseInfo.push(obj);
			}
			else if (objectInfo == "add-page"){
				//console.log("Page object added");
				
				var pageName = this.state.pageDropdownVal;

				if (pageName.indexOf('.xls') != -1){
					pageName = pageName.substring(0, pageName.indexOf('.xls'));
				}

				obj.pageName = pageName;//this.state.pageDropdownVal;
				obj.text = "add-page";

				objectInfo = "add-page";
				caseInfo.push(obj);
			}
			else{

				var pageName;

				if (globalSearchCheckbox){
					pageName = pageFromGlobalSearch;
				}
				else
				{
					pageName = this.state.pageDropdownVal;
				}
				//console.log("case added: " + objectInfo.name);

				//console.log(this.state.pageNChilds[index + 1].childs);

				

				if (pageName.indexOf('.xls') != -1){
					pageName = pageName.substring(0, pageName.indexOf('.xls'));
				}
				
				let pageWithSubPath = pageName.split('/');

				if (pageWithSubPath.length > 0) {
					pageName = pageWithSubPath[pageWithSubPath.length - 1];
				}
				//let pagewosubpath = pageName = 
				objectInfo.pageName = pageName;//this.state.pageDropdownVal;

				//let caseInfo = 	this.state.cases;
				//caseInfo.push(objectInfo); // `index` refers to the objects logical name. Note: this is not a number
				
				//console.log(caseInfo);
				caseInfo.push(objectInfo);

			}
			
			//caseInfo.push(objectInfo);

			this.setState({
				cases: caseInfo
			})
			//console.log(this.state.cases);
		}

		/*
		handleByTextFilter(e){
			var nodeName = event.target.nodeName;

			this.setState({
				searchFilterValue: e.target.value
			},this.handleFilterChange("fromText")
			);
		}
		*/
		changeInputSearchValue(e){

			
			let sSearchText = e.target.value;

			this.setState({
				searchFilterValue: e.target.value
			});

			if (sSearchText == ""){
				this.handleFilterChange("clear")
			}
		}
		
		handleFilterChange(e){// by type
			
			/*
			var nodeName = event.target.nodeName;
			var sElemType, sSearchText;
			var globalFilter = true;

			console.log(event.target.nodeName);
			console.log(e.target.value);


			if (nodeName.toLowerCase() == "input"){
				sSearchText = e.target.value;

				this.setState({
					searchFilterValue: e.target.value
				});
			}
			*/
			

			let sSearchText;
			if (e == "clear"){
				sSearchText = "";
			}
			else {
				sSearchText = this.state.searchFilterValue;

				if (this.state.globalSearchCheckbox == false && this.state.pageDropdownVal == "select"){
					alert("You must toggle `Global Filter` to true to perform a global search, \r\n or \r\n select a page to start search")
				}
			}

			var globalFilter = this.state.globalSearchCheckbox;
			

			let aElementsToFilter;

			let OS_Name = this.state.osDropdownVal.toLowerCase();

			if (globalFilter && sSearchText != ""){  /* GLOBAL FILTER */ 
				this.setState({
					showSpinner: true
				})
				/* object structure
				{screenName: "CRSCommercialServicesEnrollment.xls", subPath: "none", objects: Array(12)}

				-> objects => 	Object Name: "LinkCommercialServicesEnrollmentReport"
								Selector Type: "xpath"
								Selector Value: "//a[contains(text(),'View Commercial Services Enrollment Report')]"
				*/


				var globalObjectsPerOS;

				switch (OS_Name){ //OS_Name

					case "web":
						globalObjectsPerOS = this.state.oWebScreenNObjects;
						break;
					case "ios":
						globalObjectsPerOS = this.state.oIosScreenNObjects;
						break;
					case "android":
						globalObjectsPerOS = this.state.oAndroidScreenNObjects;
						break;
					case "other mobile pages":
						globalObjectsPerOS = this.state.oOtherMobileScreenNObjects;
						break;										
				}

				var objectsToDisplay = [];
				var objectsStruct = {};
				var found = false;
				var bWholeSeachFoundFlag = false;

				for (let repo = 0; repo < globalObjectsPerOS.length; repo++){
					
					found = false;
					console.log("repo: ", repo);
					if (repo == 16){
						console.log("Here");
					}
					if (repo == 29){
						console.log("Here");
					}

					var hasObjects = Object.keys(globalObjectsPerOS[repo]).indexOf("objects");
					if (hasObjects == -1){
						console.log("error");
					}
					else{

					
					var objectsPerPage = globalObjectsPerOS[repo].objects.filter((obj, key) =>
						{
							
							if (Object.keys(obj).length >= 3){
								let sSelectorValue = obj["Selector Value"];
								if (typeof(sSelectorValue) == "number"){
									sSelectorValue = `${sSelectorValue}`;

								}
								if (obj["Object Name"] != undefined && obj["Selector Value"] != undefined){
									if ((obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)
										|| (sSelectorValue.toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)){ // colocar validación de isNan
											found = true;
											bWholeSeachFoundFlag = true;
											return true;
									}
								}
							}
						});
					}
					if (found){
						objectsStruct.screenName = globalObjectsPerOS[repo].screenName;
						objectsStruct.objects = objectsPerPage;
						objectsToDisplay.push(objectsStruct);
						//console.log("Se encontró: ", objectsToDisplay);
						objectsStruct = {}
					}
					
				}
				if (!bWholeSeachFoundFlag){
					var x = document.getElementById("snackbar");
					x.className = "show";
					setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
					
				}
				//console.log("objectsToDisplay: " ,objectsToDisplay);

				this.setState({
					globalFilteredElements: objectsToDisplay,
					showSpinner: false
				})
				//aElementsToFilter = "";
			}
			else if (globalFilter && sSearchText == ""){
				this.setState({
					globalFilteredElements: [],
					showSpinner: false
				});
			}
			else if((this.state.pageDropdownVal != "select") && (globalFilter == false)) { /* LOCAL FILTER */
				this.setState({
					showSpinner: true
				})
				aElementsToFilter = this.state.elements;
				

				var aByNameOrText = aElementsToFilter.filter((obj) => // replace elements by filteredElements
					{
						if (Object.keys(obj).length >= 3){
							if (obj["Value"] != null){
								if ((obj["Value"].toString().toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0) 
									|| (obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)
									|| (obj["Selector Value"].toString().toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)){
										bWholeSeachFoundFlag = true;
										return true; //obj["Value"].toLowerCase().indexOf(sSearchText.toLowerCase())
								}
								/*else if (obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0){
									return true; //(obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase())  >= 0 );
								}
								else if (obj["Selector Value"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0){
									return true; //(obj["Selector Value"].toLowerCase().indexOf(sSearchText.toLowerCase())  >= 0 );
								}*/
								//	return (obj["Selector Value"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0);
							}
							else {
								console.log(obj);
								if ((obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)
									|| (obj["Selector Value"].toString().toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0)){
										bWholeSeachFoundFlag = true;
										return true; //(obj["Object Name"].toLowerCase().indexOf(sSearchText.toLowerCase())  >= 0 );
								}
								/*else if (obj["Selector Value"].toLowerCase().indexOf(sSearchText.toLowerCase()) >= 0){
									return true; //(obj["Selector Value"].toLowerCase().indexOf(sSearchText.toLowerCase())  >= 0 );
								}*/
								
							}
						}
					}
				);

				if (!bWholeSeachFoundFlag){
					var x = document.getElementById("snackbar");
					x.className = "show";
					setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
					
				}
				//console.log("aByNameOrText", aByNameOrText);
				this.setState({
					filteredElements: aByNameOrText,
					showSpinner: false
				});
			}
			else if((this.state.pageDropdownVal == "select") && (globalFilter == true)) {

			}
			
		}

        OSChange(event){

			

			this.hideToggableElements();

			let sSelectedOS = event.target.value;
			let aPagesDropdown;

			if (sSelectedOS == "android"){
				aPagesDropdown = this.state.aAndroidScreens;
			}
			else if (sSelectedOS == "ios"){
				aPagesDropdown = this.state.aIosScreens;
			}
			else if (sSelectedOS == "web"){
				aPagesDropdown = this.state.aWebScreens;
			}
			else if (sSelectedOS.toLowerCase() == "other mobile pages"){
				aPagesDropdown = this.state.aOtherMobileScreens;
			}
			else {
				aPagesDropdown = ["----"];
				console.log("no OS pages found");
			}
			//browserPages
			if (sSelectedOS != "select"){
				
				//let arrayIndex;
				/*
				for (let i = 0; i < this.state.os.length; i++){
					if (this.state.os[i] == selectedBrowser){
						arrayIndex = i;
						break;
					}
				}
				*/
				
				//console.log("arrayIndex", arrayIndex);
				//console.log("browserPages[arrayIndex]", this.state.browserPages[arrayIndex]);
				this.setState({
					//showSpinner: true,
					osDropdownVal: sSelectedOS,//event.target.value,
					pagesDropdown: aPagesDropdown,//this.state.browserPages[arrayIndex],
					filteredElements: [],
					sElementsFilter: "select",
					pageDropdownVal: "select",
					aPagesDropdownCount: aPagesDropdown.length,
					globalFilteredElements: [],
					searchFilterValue: "",
					globalSearchCheckbox: false
					//pageDropdownVal: "select"
				});

			}
			else{
				this.setState({
					osDropdownVal: sSelectedOS,// event.target.value,
					pagesDropdown: [],
					filteredElements: [], //// new
					globalFilteredElements: [],
					sElementsFilter: "select",
					oAndroidScreenNObjects: [],
					//aAndroidScreens: [], //why[]?
					//aIosScreens: [], //why[]?
					oIosScreenNObjects: [],
					oGitlabWebScreenNObjects: [],
					//aWebScreens: [], //why[]?
					//os: [],
					showSpinner: false,
					searchFilterValue: "",
					globalSearchCheckbox: false
				});
			}
			// IF GITLAB SOURCE THEN


			if (this.state.sourceOption.toLowerCase() == "gitlab"){
				this.setState({
					showSpinner: true
				})

				for (let p = 0; p < aPagesDropdown.length; p++){
					this.fetchGitlabPageObjects(aPagesDropdown[p], sSelectedOS);

					// puedo pasar el numero de paginas. En cada request colocar un counter cuando todos terminen, cambiar de estatus un flag.
				}
			}
			
        }
		fetchGitlabPageObjects(sPageName, sSelectedOS){
			var selectedProject = this.state.gitlabProjectName;
			
			var projects = this.state.gitlabListOfProjects;//this.state.gitlabProjectsName;
			var projectsID = this.state.gitlabProjectID;
			//AndroidCIBPAccounts.xls
			var idx = projectsID[projects.indexOf(selectedProject)];
			/////////
			let encodedPathAndName;

			if(sPageName.indexOf("/") > 0){
				encodedPathAndName = sPageName.replaceAll('/', '%2F');
			}
			else {
				encodedPathAndName = sPageName;
			}

			if (sSelectedOS != "web"){ //this.state.osDropdownVal
				var url = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/files/mobile-keyword-test-automation-framework%2Fsrc%2Ftest%2Fresources%2Fobjectrepository%2F"+ encodedPathAndName +"/raw?" + this.state.token + "&ref=" + this.state.gitlabBranchName;
			}
			else {
				var url = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/files/keyword-test-automation-framework%2Fsrc%2Ftest%2Fresources%2Fobjectrepository%2F"+ encodedPathAndName +"/raw?" + this.state.token + "&ref=" + this.state.gitlabBranchName;
			}
			var sOSReadIfAndroid = sPageName.toLowerCase().indexOf("android");
			var sOSReadIfIos= sPageName.toLowerCase().indexOf("ios");

			
			// then select the right URL
			//////////
			

			var req = new XMLHttpRequest();

			req.responseType = "arraybuffer";

			var _this = this;
			var aStepsToAppend;

			//req.onload = function(e) {
			req.onreadystatechange = function(e){
			var data = new Uint8Array(req.response);
				if (this.readyState == 4){
					if (this.status == 200){
						var workbook = XLSX.read(data, {type:"array"});
						//console.log(workbook);
					
						//workbook.SheetNames.forEach(function(sheet){
							//var ul = document.getElementById("sheet-list");

							aStepsToAppend = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[workbook.SheetNames[0]])//workbook.Sheets[sheet]) //, {header: 1}
							_this.updateORObjectsInfo(sPageName, aStepsToAppend);
							
							_this.setState({
								iORProgressCount: _this.state.iORProgressCount + 1,
							});

							console.log("completed: " + _this.state.aPagesDropdownCount + "/" + _this.state.iORProgressCount);

							if (_this.state.aPagesDropdownCount == _this.state.iORProgressCount){
								_this.setState({
									showSpinner: false,
									iORProgressCount: 0
								})
								alert("Done");
								console.log("Failed objects: ", _this.state.aFailedObjects);
								console.log("all objects in project: ", _this.state.allObjectsInProject);
								
								//alert("completed: " + _this.state.aPagesDropdownCount + "/" + _this.state.iORProgressCount);
							}

								//console.log(aStepsToAppend);
							// _thisAppScope.setState({                          })
							//}
						
						//});	
						
					}
				}
			/* DO SOMETHING WITH workbook HERE */
			}

			req.open("GET", url, true);
			req.send();
		

		}
		pageChange(event){
			this.hideToggableElements();
			
			let gitlabProjectName = this.state.gitlabProjectName;
			let sPageName = event.target.value;

			this.setState({
				pageDropdownVal: sPageName,
				searchFilterValue: "",
				globalSearchCheckbox: false
			})

			let sOSName = this.state.osDropdownVal;

			if (false) { //(gitlabProjectName != "select"){
				this.fetchGitlabPageObjects(sPageName, sOSName);
			}
			
			else {
				let sPageName = event.target.value;

				let sSelectedOS = this.state.osDropdownVal;
				//console.log("pageChange occured", event.target.value);
				this.setState({
					pageDropdownVal: sPageName,
				})

				if (sPageName != "select"){
					
					let iScreensCount, aOSScreens, aOSScreensInOR;

					if (sSelectedOS == "android"){
						//aPagesDropdown = this.state.aAndroidScreens;
						iScreensCount = this.state.oAndroidScreenNObjects.length;
						aOSScreensInOR = this.state.oAndroidScreenNObjects;
					}
					else if (sSelectedOS == "ios"){
						//aPagesDropdown = this.state.aIosScreens;
						iScreensCount = this.state.oIosScreenNObjects.length;
						aOSScreensInOR = this.state.oIosScreenNObjects;
					}
					else if (sSelectedOS == "web"){
						//aPagesDropdown = this.state.aIosScreens;
						iScreensCount = this.state.oWebScreenNObjects.length;
						aOSScreensInOR = this.state.oWebScreenNObjects;
					}
					else if (sSelectedOS.toLocaleLowerCase() == "other mobile pages"){
						//aPagesDropdown = this.state.aIosScreens;
						iScreensCount = this.state.oOtherMobileScreenNObjects.length;
						aOSScreensInOR = this.state.oOtherMobileScreenNObjects;
					}
					else {
						//aPagesDropdown = ["----"];
						console.log("no OS pages found");
					}

					console.log(this.state.osDropdownVal + " : " + event.target.value);

					//let sSelectedOS = this.state.osDropdownVal; //selectedBrowser
					//let selectedPage = event.target.value; == sPageName
					
					
					for (let s = 0; s < iScreensCount; s++){
						if (sPageName == aOSScreensInOR[s].screenName){
							this.setState({
								filteredElements: aOSScreensInOR[s].objects,
								elements: aOSScreensInOR[s].objects,
								sElementsFilter: "select"
							});
							break;
						}	
					}

				} // if !=select
				else{
					this.setState({
						filteredElements: [],//aAllElements,//allPages[Pi].childObjects,
						sElementsFilter: "select"
					});
				}
			}
		}
		/*
			.browserName
				.pages
					.pageName
						.childObjects
		*/

		branchReset(){

			this.hideToggableElements();

			this.setState({
				//gitlabBranchName: "select",
				//projectBranches: [],
				os: [],
				osDropdownVal: "select",
				pageDropdownVal: "select",
				filteredElements: [],
				sElementsFilter: "select", // this type of search is not being used, but variable is kept is case of further need
				pagesDropdown: [],
				oAndroidScreenNObjects: [],
				aAndroidScreens: [],
				oIosScreenNObjects: [],
				aIosScreens: [],
				oWebScreenNObjects: [],
				aWebScreens: [],
				globalFilteredElements: [],
				globalSearchCheckbox: false,
				searchFilterValue: ""
				// should I also clear "elements" to []???
			})
		}
		projectReset(){
		// reset branches
			this.setState({
				gitlabBranchName: "select",
				projectBranches: [],
				os: [],
				pageDropdownVal: "select",
				osDropdownVal: "select",
				filteredElements: [],
				sElementsFilter: "select", // this type of search is not being used, but variable is kept is case of further need
				pagesDropdown: [],
				oAndroidScreenNObjects: [],
				aAndroidScreens: [],
				oIosScreenNObjects: [],
				aIosScreens: [],
				oWebScreenNObjects: [],
				aWebScreens: []
				// should I also clear "elements" to []???
			})
		}
		stopSpinner(){
			this.setState({
				showSpinner: false
			})
		}

		gitlabBranchChange(event){

			this.branchReset();
			
			var selectedBranch = event.target.value;

			this.setState({
				gitlabBranchName: selectedBranch
			})

			if (selectedBranch != "select"){
				
				var selectedProject = this.state.gitlabProjectName;
			
				var projects = this.state.gitlabListOfProjects;//this.state.gitlabProjectsName;
				var projectsID = this.state.gitlabProjectID;

				var idx = projectsID[projects.indexOf(selectedProject)];

				//https://gitlab.evertecinc.com/api/v4/projects/492/repository/tree?path=keyword-test-automation-framework/src/test/resources/objectrepository&ref=develop&private_token=y-cu6cTeV4QM_zquJpte&per_page=100
				var webPath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=keyword-test-automation-framework/src/test/resources/objectrepository&ref=" + selectedBranch + "&" + this.state.token + "&per_page=100";
				var mobilePath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=mobile-keyword-test-automation-framework/src/test/resources/objectrepository&ref=" + selectedBranch + "&" + this.state.token + "&per_page=100";

				var response = this.fetchBranchRepos(webPath, 'web');
				var response = this.fetchBranchRepos(mobilePath, 'mobile');

				var webFeaturesPath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=keyword-test-automation-framework/src/test/resources/features&ref=" + selectedBranch + "&" + this.state.token + "&per_page=100";
				var mobileFeaturesPath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=mobile-keyword-test-automation-framework/src/test/resources/features&ref=" + selectedBranch + "&" + this.state.token + "&per_page=100";
				this.fetchBranchFeatures(webFeaturesPath);
				this.fetchBranchFeatures(mobileFeaturesPath);
				
				//console.log(response);
				//var aRepos = JSON.parse(response);
				//_this.createGitlabORStructur e(response);

				
			//var url = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/files/mobile-keyword-test-automation-framework%2Fsrc%2Ftest%2Fresources%2Fobjectrepository%2FAndroidCIBPAccounts.xls/raw?private_token=y-cu6cTeV4QM_zquJpte&ref=develop";
			}
		}
		fetchBranchFeatures(url){
			var xhttp = new XMLHttpRequest();
			var _this = this;

			var error = false;
			var response; 
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4){
					if(this.status == 200) {
					
						var response = JSON.parse(this.responseText);
						_this.processFeaturesResponse(response, url);
						
					}
					else {
						console.log("error in url: " + url);
						error = true;
					}
				}
				else {
					
				}
				
			};
			xhttp.open("GET", url, true);
			xhttp.send();
			
			if (error){
				alert("Request Failed. Make sure you are connected to the VPN/Internal Network.");
				event.preventDefault();
				event.stopPropagation();
			}
		}
		processFeaturesResponse(aFeatures, url){

			var feature;
			for (feature of aFeatures){
				//console.log("url: " + url);
				let repo_pathName = feature.name;
				let type = feature.type;
				let isXLS = repo_pathName.indexOf('.xls'); 

				let path = feature.path;
				if (type == "tree" && path.toLowerCase().indexOf("callto") != -1){

					let pathParts = url.split("&ref");
					let newPath = pathParts[0] + "/" + repo_pathName + "&ref" + pathParts[1];

					this.fetchBranchFeatures(newPath); // 1. It is a repo w/o sub path
				}
				//else if (type == "tree"){
				//	let pathParts = path.split("&ref");
				//	let newPath = pathParts[0] + "/" + repo_pathName + "&ref" + pathParts[1];

				//	this.fetchBranchFeatures(newPath); // 1. It is a repo w/o sub path
				//}
				else if (type == "blob"){
					//this.createGitlabORStructure2(repo_pathName, sOSType, path); // 2. It already went through subpath search and ended here after reaching the .xls file
					/*
						Store information in STATE variable
					*/
					var callToFeatures = this.state.callToFeatures;
					callToFeatures.unshift({"path": url, "name": feature.name});
					//console.log("callToFeatures: ", callToFeatures);
					this.setState({
						callToFeatures: callToFeatures
					})
				}
				else {
					//nothing
				}	
			}
			
		}
		gitlabProjectChange(event){
			
			//this.projectReset();

			var selectedProject = event.target.value;

			if (selectedProject != "select"){
				this.setState({
					gitlabProjectName: selectedProject
				})
				var branchesUrl;
				if (this.state.gitlabDynamicProjectID == 0){
					switch (selectedProject.toLowerCase()){
						case "devcibp":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/492/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "qacibp":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/961/repository/branches?" + this.state.token + "&per_page=100";
							break;	
						case "pics":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/701/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "pays":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/743/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "ebts":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/604/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "pcas":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/750/repository/branches?" + this.state.token + "&per_page=100";
							break;
						default:
					}
				}
				else {
					branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/"+ this.state.gitlabDynamicProjectID + "/repository/branches?" + this.state.token + "&per_page=100";
				}
// Make a request for a user with a given ID

				/* set up async GET request 	*/
				var xhttp = new XMLHttpRequest();
				var _this = this;

				var error = false;
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4){
						
						if (this.status == 200) {
							var response = JSON.parse(this.responseText);

							var availableBranches = [];
							var branch;
							for (branch of response){
								availableBranches.push(branch.name);
							}

							_this.setState({
								projectBranches: availableBranches
							})
						}
						else {
							error = true;
						}
					}
				};
				xhttp.open("GET", branchesUrl, true);
				xhttp.send();

				if (error){
					alert("Request Failed. Make sure you are connected to the VPN/Internal Network.");
					event.preventDefault();
					event.stopPropagation();
				}
			
			}
			else{
				this.setState({
					gitlabBranchName: "select",
					gitlabProjectName: "select",
					projectBranches: []
				})
			}
		}
		fetchGitlabProjectBranches(proyect){
			
			//this.projectReset();

			var selectedProject = proyect;//event.target.value;

			if (selectedProject != "select"){
				this.setState({
					gitlabProjectName: selectedProject
				})
				var branchesUrl;

				if (this.state.gitlabDynamicProjectID == 0){

					switch (selectedProject.toLowerCase()){
						case "cibp":
						branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/492/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "ebss":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/701/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "pays":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/743/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "ebts":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/604/repository/branches?" + this.state.token + "&per_page=100";
							break;
						case "pcas":
							branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/750/repository/branches?" + this.state.token + "&per_page=100";
							break;
						default:
					}
				}
				else {
					branchesUrl = "https://gitlab.evertecinc.com/api/v4/projects/"+ gitlabDynamicProjectID + "/repository/branches?" + this.state.token + "&per_page=100";
				}
				
				/* branches: 
				[["CIBP", "EBSS", "PAYS", "EBTS", "PCAS"],[492, 701, 743, 604, 750]]
				*/
				/* set up async GET request */
				var xhttp = new XMLHttpRequest();
				var _this = this;

				var error = false;
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4){
						
						if (this.status == 200) {
							var response = JSON.parse(this.responseText);

							var availableBranches = [];
							var branch;
							for (branch of response){
								availableBranches.push(branch.name);
							}

							_this.setState({
								projectBranches: availableBranches
							})
						}
						else {
							error = true;
						}
					}
				};
				xhttp.open("GET", branchesUrl, true);
				xhttp.send();

				if (error){
					alert("Request Failed. Make sure you are connected to the VPN/Internal Network.");
					event.preventDefault();
					event.stopPropagation();
				}
				
			}
			else{
				this.setState({
					gitlabBranchName: "select",
					gitlabProjectName: "select",
					projectBranches: []
				})
			}
		}
		export(){
			var modal = document.getElementById("modal");
				modal.style.display = "block";

			var table = document.getElementById("toEx");
			var rows = table.rows.length;//rows[2].cells[0];
			var actions = [];
			var sAction, sObject, sInput, sOutput, sComment;

			for (let r = 1; r < rows; r++){
				/*if (r==1){
					sAction = table.rows[r].cells[0].innerText;
					sObject =  table.rows[r].cells[1].innerText;
					sInput = table.rows[r].cells[2].getElementsByTagName("textarea")[0].value;
					sOutput = table.rows[r].cells[3].innerText;
					sComment = table.rows[r].cells[4].getElementsByTagName("textarea")[0].value;
				}
				else {
					*/
					if (table.rows[r].cells[1].firstChild == null){
						sObject =  table.rows[r].cells[1].innerText;
					}
					else {
						if (table.rows[r].cells[1].firstChild.nodeName == "TEXTAREA") {
							sObject =  table.rows[r].cells[1].firstChild.value;
						}
						else{
							sObject =  table.rows[r].cells[1].innerText;
						}
					}

					if (table.rows[r].cells[3].firstChild == null){
						//sObject =  table.rows[r].cells[3].innerText;
						sOutput = table.rows[r].cells[3].innerText;
					}
					else {
						if (table.rows[r].cells[3].firstChild.nodeName == "TEXTAREA") {
							sOutput = table.rows[r].cells[3].getElementsByTagName("textarea")[0].value;
							//sObject =  table.rows[r].cells[3].firstChild.value;
						}
					}
					sAction = table.rows[r].cells[0].getElementsByTagName("select")[0].value;
					
					sInput = table.rows[r].cells[2].getElementsByTagName("textarea")[0].value;
					
					sComment = table.rows[r].cells[4].getElementsByTagName("textarea")[0].value;
				//}
				//console.log(action);
				actions.push(
					<tr key={r}>
							<td>{sAction}</td>
							<td>{sObject}</td>
							<td>{sInput}</td>
							<td>{sOutput}</td>
							<td>{sComment}</td>
					</tr>
				);
			}
			
			this.setState({
				actionsss: actions
			})
		}

		orHealthyCheck(sSheetName, aORInfo){
			let orObjectsCount = aORInfo.length
			let aFailedObjects = [];
			let struct = {};

			let aRepositoryKeys;
			let object;
			let hasIssues = false;


			//ObjectName = oAllElements[el][aRepositoryKeys[0]];
			let sSelectorValue;
		//	aFailedObjects = this.state.aFailedObjects;
			this.setState({
				allObjectsInProject: this.state.allObjectsInProject + orObjectsCount
			})

			for (let a = 0; a < orObjectsCount; a++){
				object = aORInfo[a];
				
				aRepositoryKeys = Object.keys(object);

				//console.log("aRepositoryKeys", aRepositoryKeys);

				

				if (this.state.iORProgressCount == 82){
				//	console.log("count: ", a);
				//	console.log("here");
				}
				sSelectorValue = object[aRepositoryKeys[2]];

				if (typeof(sSelectorValue) != "string"){
					hasIssues = true;
					struct.sheetname = sSheetName;
					struct.keys = Object.keys(object).toString();

					aFailedObjects.push(struct);
					struct = {};
					
					console.log("a: " + a + "object: " + object[aRepositoryKeys[0]]);
					//console.log("Object Name wrong: ", aRepositoryKeys[0])
				}
				else {
					if (sSelectorValue.indexOf("/html/body") != -1){
						hasIssues = true;
						struct.sheetname = sSheetName;
						struct.objectname = object[aRepositoryKeys[0]];
						struct.selectorvalue = sSelectorValue;
						aFailedObjects.push(struct);
						struct = {};
					}
				}
				
			}

			if (hasIssues){
				let storedFailedObjects = this.state.aFailedObjects;
				let newConcat = storedFailedObjects.concat(aFailedObjects);
			
				this.setState({
					aFailedObjects: newConcat
				});
			}
			
		}

		updateORObjectsInfo(sSheetName, aORInfo){

			this.orHealthyCheck(sSheetName, aORInfo);

			var sOSReadIfAndroid = sSheetName.toLowerCase().indexOf("android");
			var sOSReadIfIos= sSheetName.toLowerCase().indexOf("ios");
			var sOSName;

			var oSheetsStruct = {};
//////
//////
////////////////////////////////////////////////////////////
////// tengo que validar que el .objects ya no se haya añadido
//////
//////
			let osValue = this.state.osDropdownVal.toLowerCase();
			if (osValue == "android"){//(sOSReadIfAndroid >= 0){
				sOSName = "android";

				var aCurrentScreens = this.state.aAndroidScreens; //aGitlabAndroidScreens
				var repoIDInArray = aCurrentScreens.indexOf(sSheetName);
				//aCurrentScreens.push(sSheetName);
				var oAndroidScreenNObjects = this.state.oAndroidScreenNObjects; //oGitlabAndroidScreenNObjects

				oAndroidScreenNObjects[repoIDInArray].objects = aORInfo;
				//oSheetsStruct.screenName = sSheetName;
				//oSheetsStruct.objects = aSheetInfo;
				//oAndroidScreenNObjects.push(oSheetsStruct);
				this.setState({
					//aAndroidScreens: aCurrentScreens,//aGitlabAndroidScreens: aCurrentScreens,
					oAndroidScreenNObjects: oAndroidScreenNObjects //oGitlabAndroidScreenNObjects: oAndroidScreenNObjects
				});

			}
			else if (osValue == "ios"){//(sOSReadIfIos >= 0){
				sOSName = "ios";

				var aCurrentScreens = this.state.aIosScreens; //aGitlabIosScreens
				var repoIDInArray = aCurrentScreens.indexOf(sSheetName);
					//aCurrentScreens.push(sSheetName);

				var oIosScreenNObjects = this.state.oIosScreenNObjects; //oGitlabIosScreenNObjects

				oIosScreenNObjects[repoIDInArray].objects = aORInfo;									
				//oSheetsStruct.screenName = sSheetName;
				//oSheetsStruct.objects = aSheetInfo;

				//oIosScreenNObjects.push(oSheetsStruct);

				this.setState({
					//aIosScreens: aCurrentScreens, //aGitlabIosScreens: aCurrentScreens,
					oIosScreenNObjects: oIosScreenNObjects //oGitlabIosScreenNObjects: oIosScreenNObjects
				});
			}
			else if (osValue == "other mobile pages"){
				sOSName = "other mobile pages";

				var aCurrentScreens = this.state.aOtherMobileScreens; //aGitlabIosScreens
				var repoIDInArray = aCurrentScreens.indexOf(sSheetName);
					//aCurrentScreens.push(sSheetName);

				var oOtherMobileScreenNObjects = this.state.oOtherMobileScreenNObjects;//oIosScreenNObjects = this.state.oIosScreenNObjects; //oGitlabIosScreenNObjects

				oOtherMobileScreenNObjects[repoIDInArray].objects = aORInfo;									
				//oSheetsStruct.screenName = sSheetName;
				//oSheetsStruct.objects = aSheetInfo;

				//oIosScreenNObjects.push(oSheetsStruct);

				this.setState({
					//aIosScreens: aCurrentScreens, //aGitlabIosScreens: aCurrentScreens,
					oOtherMobileScreenNObjects: oOtherMobileScreenNObjects //oGitlabIosScreenNObjects: oIosScreenNObjects
				});
			}
			else if(osValue == "web"){
				
				sOSName = "web";

				var aCurrentScreens = this.state.aWebScreens;//aGitlabWebScreens
				var repoIDInArray = aCurrentScreens.indexOf(sSheetName);
					//aCurrentScreens.push(sSheetName);

				var oWebScreenNObjects = this.state.oWebScreenNObjects; //oGitlabWebScreenNObjects
				oWebScreenNObjects[repoIDInArray].objects = aORInfo;																
				//oSheetsStruct.screenName = sSheetName;
				//oSheetsStruct.objects = aSheetInfo;

				//oWebScreenNObjects.push(oSheetsStruct);

				this.setState({
					//aWebScreens: aCurrentScreens,//aGitlabWebScreens: aCurrentScreens,
					oWebScreenNObjects: oWebScreenNObjects //oGitlabWebScreenNObjects: oWebScreenNObjects
				});
			}

/////////////// EXPERIMENTAL Y TEMPORERO
				let sSelectedOS = this.state.osDropdownVal;
				//console.log("pageChange occured", event.target.value);
				let sPageName = this.state.pageDropdownVal;

				if (sPageName != "select"){
					
					let iScreensCount, aOSScreens, aOSScreensInOR;

					if (sSelectedOS == "android"){
						//aPagesDropdown = this.state.aAndroidScreens;
						iScreensCount = this.state.oAndroidScreenNObjects.length;
						aOSScreensInOR = this.state.oAndroidScreenNObjects;
					}
					else if (sSelectedOS == "ios"){
						//aPagesDropdown = this.state.aIosScreens;
						iScreensCount = this.state.oIosScreenNObjects.length;
						aOSScreensInOR = this.state.oIosScreenNObjects;
					}
					else if (sSelectedOS == "web"){
						//aPagesDropdown = this.state.aIosScreens;
						iScreensCount = this.state.oWebScreenNObjects.length;
						aOSScreensInOR = this.state.oWebScreenNObjects;
					}
					else if (sSelectedOS.toLocaleLowerCase() == "other mobile pages"){
						iScreensCount = this.state.oOtherMobileScreenNObjects.length;
						aOSScreensInOR = this.state.oOtherMobileScreenNObjects;
					}
					else {
						//aPagesDropdown = ["----"];
						console.log("no OS pages found");
					}

					console.log(this.state.osDropdownVal + " : " + event.target.value);

					//let sSelectedOS = this.state.osDropdownVal; //selectedBrowser
					//let selectedPage = event.target.value; == sPageName
					
					
					for (let s = 0; s < iScreensCount; s++){
						if (sPageName == aOSScreensInOR[s].screenName){
							this.setState({
								filteredElements: aOSScreensInOR[s].objects,
								elements: aOSScreensInOR[s].objects,
								sElementsFilter: "select"
							});
							break;
						}	
					}

				} // if !=select
				else{
					this.setState({
						filteredElements: [],//aAllElements,//allPages[Pi].childObjects,
						sElementsFilter: "select"
					});
				}


//////////////
		}

		fetchBranchReposCB(url, sOSType, callback){
			var xhttp = new XMLHttpRequest();
			var _this = this;

			var error = false;
			var response; 
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4){
					if(this.status == 200) {
					
						var response = JSON.parse(this.responseText);
						//_this.createGitlabORStructure(response, sOSType, url);
						callback(response, sOSType, url);
					}
					else {
						error = true;
					}
				}
				
			};
			xhttp.open("GET", url, true);
			xhttp.send();
			
			if (error){
				alert("Request Failed. Make sure you are connected to the VPN/Internal Network.");
				event.preventDefault();
				event.stopPropagation();
			}

		}

		fetchBranchRepos(url, sOSType){
			var xhttp = new XMLHttpRequest();
			var _this = this;

			var error = false;
			var response; 
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4){
					if(this.status == 200) {
					
						var response = JSON.parse(this.responseText);
						_this.createGitlabORStructure(response, sOSType, url);
						
					}
					else {
						error = true;
					}
				}
				
			};
			xhttp.open("GET", url, true);
			xhttp.send();
			
			if (error){
				alert("Request Failed. Make sure you are connected to the VPN/Internal Network.");
				event.preventDefault();
				event.stopPropagation();
			}

		}

		createGitlabORStructure(aOR, sOSType, path){

			var objectRepo;
			for (objectRepo of aOR){

				let repo_pathName = objectRepo.name;

				let isXLS = repo_pathName.indexOf('.xls'); 

				let url = path
				if (isXLS == -1){

					let pathParts = path.split("&ref");
					let newPath = pathParts[0] + "/" + repo_pathName + "&ref" + pathParts[1];

					this.fetchSubDirectories(newPath, sOSType); // 1. It is a repo w/o sub path
				}
				else {
					this.createGitlabORStructure2(repo_pathName, sOSType, path); // 2. It already went through subpath search and ended here after reaching the .xls file
				}
				
			}

		}

		fetchSubDirectories(Path, sOSType){
			var selectedProject = this.state.gitlabProjectName;
			
			var projects = this.state.gitlabListOfProjects;//this.state.gitlabProjectsName;
			var projectsID = this.state.gitlabProjectID;

			var idx = projectsID[projects.indexOf(selectedProject)];
			var selectedBranch = this.state.gitlabBranchName;

			//https://gitlab.evertecinc.com/api/v4/projects/492/repository/tree?path=keyword-test-automation-framework/src/test/resources/objectrepository&ref=develop&private_token=y-cu6cTeV4QM_zquJpte&per_page=100
			
			if (sOSType == 'mobile'){
				//var mobilePath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=mobile-keyword-test-automation-framework/src/test/resources/objectrepository/" + subPath + "&ref=" + selectedBranch + "&private_token=y-cu6cTeV4QM_zquJpte&per_page=100";
				var response = this.fetchBranchRepos(Path, 'mobile');//### original
				//var response = this.fetchBranchReposCB(Path, 'mobile');
			}
			else {
			//	var webPath = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/tree?path=keyword-test-automation-framework/src/test/resources/objectrepository/" + subPath + "&ref=" + selectedBranch + "&private_token=y-cu6cTeV4QM_zquJpte&per_page=100";
				var response = this.fetchBranchRepos(Path, 'web');//### original
				//var response = this.fetchBranchReposCB(Path, 'web', this.createGitlabORStructure);
			}
			
		}


		createGitlabORStructure2(sORName, sOSType, path){

			let pathParts = path.split("&ref");
			let after_objectrepository = pathParts[0].split("objectrepository/");

			var subPath = "none";

			if (after_objectrepository.length > 1){ // has sub paths
				let repoSubPath = after_objectrepository[1];//pathParts[0] + "/" + repo_pathName + "&ref" + pathParts[1];

				subPath = repoSubPath;//subPathChunck.split(sORName)[0];

			}
			

			var sOSReadIfAndroid = sORName.toLowerCase().indexOf("android");
			var sOSReadIfIos= sORName.toLowerCase().indexOf("ios");
			var sOSName;

			var oSheetsStruct = {};

			//let isXLS = sORName.indexOf('.xls'); 

			if (false) { //(isXLS == -1){
				//this.fetchSubDirectories(sORName, sOSType);
			}
			else {
				var sSheetName = sORName;//.substring(0, sORName.indexOf('.xls')); 
				// NO puedo remover el .xls

				if (sOSReadIfAndroid >= 0 && sOSType == 'mobile'){
					sOSName = "android";

					var aCurrentScreens = this.state.aAndroidScreens; //aGitlabAndroidScreens
						//aCurrentScreens.push(sSheetName);//subPath + "/"+ 
					
					var oAndroidScreenNObjects = this.state.oAndroidScreenNObjects; //oGitlabAndroidScreenNObjects
										
					if (subPath != "none"){
						aCurrentScreens.push(subPath + "/" + sSheetName);//
						oSheetsStruct.screenName = subPath + "/"+ sSheetName;
						oSheetsStruct.sSheetName = sSheetName;
					}
					else{
						aCurrentScreens.push(sSheetName);
						oSheetsStruct.screenName = sSheetName;
					}										
					
					oSheetsStruct.subPath = subPath;

					//oSheetsStruct.objects = aSheetInfo;

					oAndroidScreenNObjects.push(oSheetsStruct);

					this.setState({
						aAndroidScreens: aCurrentScreens,//aGitlabAndroidScreens: aCurrentScreens,
						oAndroidScreenNObjects: oAndroidScreenNObjects //oGitlabAndroidScreenNObjects: oAndroidScreenNObjects
					});


				}
				else if (sOSReadIfIos >= 0 && sOSType == 'mobile'){
					sOSName = "ios";

					var aCurrentScreens = this.state.aIosScreens; //aGitlabIosScreens
						//aCurrentScreens.push(sSheetName);//subPath + "/"+ 

					var oIosScreenNObjects = this.state.oIosScreenNObjects; //oGitlabIosScreenNObjects
										
					if (subPath != "none"){
						aCurrentScreens.push(subPath + "/" + sSheetName);
						oSheetsStruct.screenName = subPath + "/"+ sSheetName;
						oSheetsStruct.sSheetName = sSheetName;
					}
					else{
						aCurrentScreens.push(sSheetName);
						oSheetsStruct.screenName = sSheetName;
					}
					oSheetsStruct.subPath = subPath;
					//oSheetsStruct.objects = aSheetInfo;

					oIosScreenNObjects.push(oSheetsStruct);

					this.setState({
						aIosScreens: aCurrentScreens, //aGitlabIosScreens: aCurrentScreens,
						oIosScreenNObjects: oIosScreenNObjects //oGitlabIosScreenNObjects: oIosScreenNObjects
					});
				}
				else if (sOSType == 'mobile') {

					sOSName = "mobile";

					var aCurrentScreens = this.state.aOtherMobileScreens; //aGitlabIosScreens
						//aCurrentScreens.push(sSheetName);//subPath + "/"+ 

					var oOtherMobileScreenNObjects = this.state.oOtherMobileScreenNObjects; //oGitlabIosScreenNObjects
										
					if (subPath != "none"){
						aCurrentScreens.push(subPath + "/"+ sSheetName);//
						oSheetsStruct.screenName = subPath + "/"+ sSheetName;
						oSheetsStruct.sSheetName = sSheetName;
					}
					else{
						aCurrentScreens.push(sSheetName);
						oSheetsStruct.screenName = sSheetName;
					}
					oSheetsStruct.subPath = subPath;
					//oSheetsStruct.objects = aSheetInfo;

					oOtherMobileScreenNObjects.push(oSheetsStruct);

					this.setState({
						aOtherMobileScreens: aCurrentScreens, //aGitlabIosScreens: aCurrentScreens,
						oOtherMobileScreenNObjects: oOtherMobileScreenNObjects //oGitlabIosScreenNObjects: oIosScreenNObjects
					});
				}
				else if (sOSType == 'web'){
					
					sOSName = "web";

					var aCurrentScreens = this.state.aWebScreens;//aGitlabWebScreens
						//aCurrentScreens.push(sSheetName);//subPath + "/"+ 

					var oWebScreenNObjects = this.state.oWebScreenNObjects; //oGitlabWebScreenNObjects
										
					if (subPath != "none"){
						aCurrentScreens.push(subPath + "/"+ sSheetName);//
						oSheetsStruct.screenName = subPath + "/"+ sSheetName;
						oSheetsStruct.sSheetName = sSheetName;
					}
					else{
						aCurrentScreens.push(sSheetName);
						oSheetsStruct.screenName = sSheetName;
					}
					oSheetsStruct.subPath = subPath;
					//oSheetsStruct.objects = aSheetInfo;

					oWebScreenNObjects.push(oSheetsStruct);

					this.setState({
						aWebScreens: aCurrentScreens,//aGitlabWebScreens: aCurrentScreens,
						oWebScreenNObjects: oWebScreenNObjects //oGitlabWebScreenNObjects: oWebScreenNObjects
					});
				}

				var aOS = this.state.os;
				var bCheckAndroidExists = aOS.includes('android');
				var bCheckIOSExists = aOS.includes('ios');
				var bCheckWEBExists = aOS.includes('web');
				var bCheckOtherMobileExists = aOS.includes('Other Mobile Pages');

				if (sOSName == 'android' && !bCheckAndroidExists && sOSType == 'mobile'){
					aOS.push('android');

					this.setState({
						os: aOS
					})
				}
				if (sOSName == 'ios' && !bCheckIOSExists && sOSType == 'mobile'){
					aOS.push('ios');

					this.setState({
						os: aOS
					})
				}
				if (sOSName == 'mobile' && sOSType == 'mobile' && !bCheckOtherMobileExists){
					aOS.push('Other Mobile Pages');

					this.setState({
						os: aOS
					})
				}
				if (sOSName == 'web' && !bCheckWEBExists && sOSType == 'web'){
					aOS.push('web');

					this.setState({
						os: aOS
					})
				}
				
			}
		}
		
		updateor(sSheetName, aSheetInfo, os){
			//console.log(sSheetName, aSheetInfo);
			var sOSReadIfAndroid = -1;
			var sOSReadIfIos = -1;

			if (os == "mobile") {
				sOSReadIfAndroid = sSheetName.toLowerCase().indexOf("android");
				sOSReadIfIos = sSheetName.toLowerCase().indexOf("ios");
			}
	
			
			var sOSName;

			var oSheetsStruct = {};

			if (sOSReadIfAndroid >= 0){
				sOSName = "android";

				var aCurrentScreens = this.state.aAndroidScreens;
					aCurrentScreens.push(sSheetName);
				
				var oAndroidScreenNObjects = this.state.oAndroidScreenNObjects;
									
				oSheetsStruct.screenName = sSheetName;
				oSheetsStruct.objects = aSheetInfo;

				oAndroidScreenNObjects.push(oSheetsStruct);

				this.setState({
					aAndroidScreens: aCurrentScreens,
					oAndroidScreenNObjects: oAndroidScreenNObjects
				});


			}
			else if (sOSReadIfIos >= 0){
				sOSName = "ios";

				var aCurrentScreens = this.state.aIosScreens;
					aCurrentScreens.push(sSheetName);

				var oIosScreenNObjects = this.state.oIosScreenNObjects;
									
				oSheetsStruct.screenName = sSheetName;
				oSheetsStruct.objects = aSheetInfo;

				oIosScreenNObjects.push(oSheetsStruct);

				this.setState({
					aIosScreens: aCurrentScreens,
					oIosScreenNObjects: oIosScreenNObjects
				});
			}
			else {
				
				sOSName = "web";

				var aCurrentScreens = this.state.aWebScreens;
					aCurrentScreens.push(sSheetName);

				var oWebScreenNObjects = this.state.oWebScreenNObjects;
									
				oSheetsStruct.screenName = sSheetName;
				oSheetsStruct.objects = aSheetInfo;

				oWebScreenNObjects.push(oSheetsStruct);

				this.setState({
					aWebScreens: aCurrentScreens,
					oWebScreenNObjects: oWebScreenNObjects
				});
			}

			var aOS = this.state.os;
			var bCheckAndroidExists = aOS.includes('android');
			var bCheckIOSExists = aOS.includes('ios');
			var bCheckWEBExists = aOS.includes('web');

			if (sOSName == "android" && !bCheckAndroidExists){
				aOS.push('android');

				this.setState({
					os: aOS
				})
			}
			if (sOSName == "ios" && !bCheckIOSExists){
				aOS.push('ios');

				this.setState({
					os: aOS
				})
			}
			if (sOSName == "web" && !bCheckWEBExists){
				aOS.push('web');

				this.setState({
					os: aOS
				})
			}
		}

		uploadORSheets(){
			let currStateShowORImport = this.state.bShowORImport;
		//	console.log("clicked");
		//	console.log(currStateShowORImport);
			

			this.setState({
				bShowORImport: !currStateShowORImport
			})
		}
		chooseSource(){
			let sOptionName = event.target.value;

			this.setState({
				sourceOption: sOptionName,
			})

			let sSelectedOptionName;
			if (sOptionName.toLowerCase().indexOf("gitlab") != -1){
				sSelectedOptionName = "gitlab";
			}
			else if (sOptionName.toLowerCase().indexOf("manual") != -1){
				sSelectedOptionName = "manual";
			}
			else {
				sSelectedOptionName = "none";
			}

			this.setState({
				renderSourceOption: sSelectedOptionName,
				gitlabProjectName: "select",
				gitlabBranchName: "select",
				projectBranches: []
			})
			this.branchReset();

		}

		actionChange(event){
			this.setState({
				actionNameVal: event.target.value
			})

		//	console.log(event.target.value);

		}
		toggleSelector(){
			var toggableElements = document.getElementsByClassName('toggable-selector-name');
			let state;
			if (toggableElements.length > 0){
				let currentDisplay = toggableElements[0].style.display;
				if (currentDisplay == "none" || currentDisplay == ""){
					state = "block";
				}
				else {state = "none";}

				for (let i = 0; i < toggableElements.length; i++){
					toggableElements[i].style.display = state;
				}
			}
		}

		hideToggableElements(){
			var toggableElements = document.getElementsByClassName('toggable-selector-name');
			
			for (let i = 0; i < toggableElements.length; i++){
    			toggableElements[i].style.display = 'none';
			}	
		}
		getCallTo(e){
			//e.preventDefault();
		//	console.log("Hello Call To:");
		}
		ShowCallToSteps(iRowNumber){
			let oStepsTable = document.getElementById("toEx");
			let sCallToName = oStepsTable.rows[iRowNumber].cells[2].firstChild.value;
			let aCallToList = this.state.callToFeatures;

			let aCallToInfo;
			for (let c = 0; c < aCallToList.length; c++){
				if (aCallToList[c].name == sCallToName){
					aCallToInfo = aCallToList[c];
					break;
				}
			}
			

			let sRawCallToPath = aCallToInfo.path;
			//https://gitlab.evertecinc.com/api/v4/projects/701/repository/tree?path=keyword-test-automation-framework/src/test/resources/features/
			//CallToActions/PICS-WEB/Open-Account/SignatureAndDocuments
			//&ref=master&private_token=y-cu6cTeV4QM_zquJpte&per_page=100
			let modulePath = sRawCallToPath.split("?path=")[1]; 
				modulePath = modulePath.split("&ref")[0];//keyword-test-automation-framework/src/test/resources/features/CallToActions/PICS-WEB/Open-Account/SignatureAndDocuments
			
			let callToPathWithFileName = modulePath + "/" + sCallToName;

			let encodedPathAndName = callToPathWithFileName.replaceAll('/', '%2F');
			
			var selectedProject = this.state.gitlabProjectName;
			
			var projects = this.state.gitlabListOfProjects;//this.state.gitlabProjectsName;
			var projectsID = this.state.gitlabProjectID;
			var idx = projectsID[projects.indexOf(selectedProject)];

			var baseUrl = "https://gitlab.evertecinc.com/api/v4/projects/" + idx + "/repository/files/"; //mobile-keyword-test-automation-framework%2Fsrc%2Ftest%2Fresources%2Ffeatures%2F";
			let callToPath = encodedPathAndName +"/raw?" + this.state.token + "&ref=" + this.state.gitlabBranchName;

			let sCallToURL = baseUrl + callToPath;

			var req = new XMLHttpRequest();

			req.responseType = "arraybuffer";

			var _this = this;
			var aStepsToAppend;

			//req.onload = function(e) {
			req.onreadystatechange = function(e){
			var data = new Uint8Array(req.response);
				if (this.readyState == 4){
					if (this.status == 200){
						var workbook = XLSX.read(data, {type:"array"});
						//console.log(workbook);
					
						//workbook.SheetNames.forEach(function(sheet){
							//var ul = document.getElementById("sheet-list");

							//aStepsToAppend = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]) //, {header: 1}
							aStepsToAppend = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[workbook.SheetNames[0]]) //, {header: 1}
							_this.renderCallToTable(aStepsToAppend);
							//_this.updateORObjectsInfo(sPageName, aStepsToAppend);
								//console.log(aStepsToAppend);
							// _thisAppScope.setState({                          })
							//}
						
						//});	
					}
				}
			/* DO SOMETHING WITH workbook HERE */
			}

			req.open("GET", sCallToURL, true);
			req.send();
			/*
				find the name of the CallTo in Col 3
				find the path based on that name. path is in array callToFeatures.path
				perform fetch to get callto steps
				display a new window with a table with the steps
					add button to close window
			*/
		}

		handleGlobalSearchCheckbox(e){
		
				let value = e.target.checked;

				if (value) {

					// if globalseach is desired, then initially clear array of elements from previous search or previous list of elements that belong to a page
					this.setState({
						globalSearchCheckbox: !this.state.globalSearchCheckbox,
						pageDropdownVal: "select",
						globalFilteredElements: []
						
						//filteredElements: [],
						//globalFilteredElements: []
					})
				}
				else {
					this.setState({
						globalSearchCheckbox: !this.state.globalSearchCheckbox,
						pageDropdownVal: "select",
						filteredElements: [],
						globalFilteredElements: []
					})
				}
				//globalFilteredElements
				
		}

		renderCallToTable(steps){
			var oNewRow, oAction, oObject, oInput, oOutput, oComment, oDelete;
			var arrayIndexCounter = 0;

			//var oTable = document.createElement("TABLE");
			//	oTable.setAttribute("id", "CallToStepsTable");

			//document.body.appendChild(oTable);

			let oCallToTable = document.getElementById("CallToStepsTable");
			
			let iCurrentRows = oCallToTable.rows.length;
			for (let oldRows=1; oldRows < iCurrentRows; oldRows++){
				oCallToTable.deleteRow(1);
			}

			let oCallToModal = document.getElementById("callto-modal");
			oCallToModal.style.display = "block";
			//var oTh = document.createElement("TH");
			//var oThText = document.createTextNode("Action");
			//oTh.appendChild(oThText);
			//document.getElementById("callToTable").appendChild(oTh);

			for (let newRow = 0; newRow < steps.length; newRow++){
				oNewRow = oCallToTable.insertRow(newRow+1);
					
				oAction = oNewRow.insertCell(0);
				oObject = oNewRow.insertCell(1);
				oInput = oNewRow.insertCell(2);
				oOutput = oNewRow.insertCell(3);
				oComment = oNewRow.insertCell(4);

				oAction.innerText = steps[newRow]["Action"];

				//oObject.innerText = steps[newRow]["Object"];
				var sObject = typeof(steps[newRow]["Object"]) == "undefined" ? "": steps[newRow]["Object"];
				oObject.innerText = sObject;
				
				//oInput.innerText =steps[newRow]["Input"];
				var sInput = typeof(steps[newRow]["Input"]) == "undefined" ? "": steps[newRow]["Input"];
				oInput.innerText = sInput;

				//oOutput.innerText = steps[newRow]["Output"];
				var sOutput = typeof(steps[newRow]["Output"]) == "undefined" ? "": steps[newRow]["Output"];
				oOutput.innerText = sOutput;

				//oComment.innerText = steps[newRow]["Comment"];
				var sComment = typeof(steps[newRow]["Comment"]) == "undefined" ? "": steps[newRow]["Comment"];
				oComment.innerText = sComment;

			}


			
			/*					
			for (let r = iActualRowsCount; r <= iFinalRowsCount; r++ ){

				oNewRow = oTable.insertRow(r);
			
				oAction = oNewRow.insertCell(0);
				

				var sAction = typeof(aStepsToAppend[arrayIndexCounter]["Action"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Action"];
					sAction = sAction.trim();
			}
			*/
		}
        render() {
			let svg;
			if (this.state.osDropdownVal == "ios"){
				svg = <svg className="svgStyle" viewBox="0 0 24 24"><path fill="white" d="M19.5 15.2c-.398.902-.602 1.402-1.2 2.198C17.5 18.602 16.5 20 15.103 20c-1.204 0-1.5-.8-3.102-.8-1.602 0-1.898.8-3.102.8-1.296 0-2.296-1.3-3.097-2.5-2.102-3.2-2.301-7-1-9 .898-1.398 2.398-2.3 3.8-2.3C10 6.2 10.899 7 12 7c1.102 0 1.8-.8 3.398-.8 1.204 0 2.5.698 3.5 1.8-3 1.7-2.5 6 .602 7.2zM14.3 4.897c.598-.796 1-1.796.9-2.898-1 .102-2.098.7-2.802 1.5-.597.7-1.097 1.8-.898 2.898 1 0 2.102-.699 2.8-1.5z"></path></svg>
			}
			else if(this.state.osDropdownVal == "android"){ 
				svg = <svg className="svgStyle" viewBox="0 0 24 24"><path fill="#a4c639" d="M10.139 2.839a7.263 7.263 0 0 1 2.004-.268 7.28 7.28 0 0 1 1.973.26l.831-1.247a.75.75 0 1 1 1.248.832l-.675 1.013c1.397.836 2.217 2.2 2.337 3.714H6.43c.119-1.507.932-2.866 2.317-3.703l-.663-1.036a.75.75 0 1 1 1.263-.808l.762 1.19a.76.76 0 0 1 .031.053zM8.714 18H7.571c-.63 0-1.142-.512-1.142-1.143v-8.57h11.428v8.57c0 .631-.512 1.143-1.143 1.143h-1.143v2.857a1.143 1.143 0 0 1-2.285 0V18H11v2.857a1.143 1.143 0 0 1-2.286 0V18zm-3.428-3.428a1.143 1.143 0 0 1-2.286 0V9.429a1.143 1.143 0 0 1 2.286 0v5.143zm16 0a1.143 1.143 0 0 1-2.286 0V9.429a1.143 1.143 0 0 1 2.286 0v5.143zM9.857 5.77a.572.572 0 1 0 0-1.143.572.572 0 0 0 0 1.143zm4.572 0a.571.571 0 1 0 0-1.142.571.571 0 0 0 0 1.142z"></path></svg>
			}
			else if (this.state.osDropdownVal == "web"){
				svg = <svg className="svgStyle" viewBox="0 0 511.997 511.997"><path fill="#DD512A" d="M38.238,0c-4.706,0-8.212,3.835-7.794,8.521l39.671,444.978c0.418,4.687,4.468,9.552,9.004,10.811 
				l168.344,46.742c4.535,1.259,11.954,1.259,16.49,0.003l168.856-46.819c4.535-1.258,8.59-6.122,9.007-10.808L481.553,8.521
				C481.974,3.835,478.464,0,473.758,0H38.238z M397.068,102.054c-0.375,4.18-1.023,11.437-1.441,16.124l-1.045,11.675
				c-0.421,4.685-1.02,11.386-1.336,14.889c-0.315,3.504-0.614,6.371-0.669,6.371c-0.053,0-3.948,0-8.653,0H264.554
				c-4.706,0-8.595,0-8.646,0s-3.944,0-8.65,0H184.39c-4.706,0-8.212,3.835-7.794,8.521l3.667,40.99
				c0.418,4.685,4.612,8.521,9.317,8.521h57.679c4.706,0,8.598,0,8.65,0s3.941,0,8.646,0h99.142c4.706,0,11.988,0,16.182,0
				c4.191,0,7.312,3.421,6.932,7.601c-0.382,4.18-1.034,11.439-1.451,16.124L373.569,365.02c-0.421,4.687-0.953,10.674-1.182,13.306
				c-0.234,2.63-4.134,5.811-8.669,7.069l-99.474,27.582c-4.535,1.256-8.302,2.296-8.373,2.312c-0.07,0.015-3.836-1.003-8.373-2.26
				l-99.58-27.632c-4.535-1.258-8.587-6.122-9.004-10.809l-6.41-71.945c-0.418-4.687,3.092-8.522,7.798-8.522h9.088
				c4.706,0,12.406,0,17.111,0h13.552c4.706,0,8.896,3.835,9.317,8.522l2.514,28.164c0.418,4.687,4.475,9.524,9.019,10.751
				l46.579,12.579c4.541,1.227,8.275,2.231,8.296,2.231c0.021,0,3.753-1.006,8.296-2.233l46.663-12.609
				c4.541-1.227,8.602-6.066,9.023-10.751l5.06-56.427c0.421-4.687-3.085-8.522-7.791-8.522h-52.474c-4.706,0-8.595,0-8.646,0
				s-3.944,0-8.65,0H137.765c-4.706,0-8.896-3.836-9.314-8.521l-12.416-139.126c-0.418-4.687-1.066-11.942-1.441-16.124
				c-0.371-4.18,3.172-7.601,7.878-7.601h124.787c4.706,0,8.598,0,8.65,0s3.941,0,8.646,0h124.636
				C393.896,94.452,397.441,97.872,397.068,102.054z"/></svg>
			
			}
			else {
				svg = "";
			}
            return (
				<div className="row">
					<div id="snackbar">No elements were found...</div>
					<Modal actionsss={this.state.actionsss}/>
					<ShotCallToStepsModal />
					<ImportScreenFF delCase={this.delCase} availableActions={this.state.actions} />
                    <LoadOR uploadORSheets={this.uploadORSheets} bShowORImport={this.state.bShowORImport} updateor={this.updateor}
						stopSpinner={this.stopSpinner} />
					<div className="row">
						<div className="toolbarwrapper">
							<div className="toolbarContainer">
								<div className="selBrowser">
										Select Resitory Source
										<Dropdown dval={this.state.sourceOption} type={"page"} items={this.state.sourcesOptions} change={this.chooseSource} />
									</div>
								

								<ManualORModule renderSourceOption={this.state.renderSourceOption} uploadORSheets={this.uploadORSheets} />
								<GitlabModule 	renderSourceOption={this.state.renderSourceOption} 
												gitlabProjectName={this.state.gitlabProjectName} 
												gitlabProjectsName={this.state.gitlabProjectsName} 
												gitlabProjectChange={this.gitlabProjectChange}
												gitlabBranchName={this.state.gitlabBranchName}
												projectBranches={this.state.projectBranches} 
												gitlabBranchChange={this.gitlabBranchChange}
								/>
								
								<div className="app-page-container">
									<div className="selBrowser">
										Select OS
										<Dropdown dval={this.state.osDropdownVal} type={"os"} items={this.state.os} change={this.OSChange} 
											disabledFlag={false} />
										
									</div>
									<div className="selPage"> 
										Select Page
										<Dropdown dval={this.state.pageDropdownVal} type={"page"} items={this.state.pagesDropdown} change={this.pageChange}
											disabledFlag={false} />
									</div>
								</div>
								<div className="selBrowser">
									{svg}
								</div>
								<div className="searchFilter">
									<h3 style={{display: 'inline-block'}}>Filter</h3><i> by text or name</i>
									<div><input style={{marginLeft: '5px'}} type="text" value={this.state.searchFilterValue} onChange={this.changeInputSearchValue} /><input className="menu-button" value="Search" type="button" onClick={this.handleFilterChange}/></div>
									<input type="checkbox" name="globalFilter" checked={this.state.globalSearchCheckbox} onChange={this.handleGlobalSearchCheckbox} /><span>Global Filter</span>
									
								</div>
								<div className="toolbarExport" style={{marginTop: '22px'}}>
									<p style={{margin: '0', padding: '0'}}>Show/Hide</p><p style={{margin: '0', padding: '0'}}>Selector</p>
									<input className="menu-button" type="button" value="Toggle" onClick={this.toggleSelector} />
								</div>
								<div className="filterByType">
									<p>Filter by type</p>
									<FilterByElementsDropdown sElementsFilter={this.state.sElementsFilter} handleFilterChange={this.handleFilterChange}/>
								</div>
								{true ? <div className="toolbarExport" style={{marginTop: '22px'}}>
									<p style={{margin: '0', padding: '0'}}>Import</p><p style={{margin: '0', padding: '0'}}>Feature</p>
									<input className="menu-button" value="Import" type="button" onClick={this.showImportOptions}/>
									 
								</div>: ""}
								<div className="toolbarExport">
									<p>Export</p>
									
									<input className="menu-button" type="button" value="Export" onClick={this.export}/>	
								</div>
								
							</div>
						</div>		
						
							<div className="tablesContainer">
								<div className="elementsTable">
									<Elements xmlReadDone={this.state.xmlReadDone} tableChilds={this.state.filteredElements} globalFilteredElements={this.state.globalFilteredElements} addCase={this.addCase}
										oWebScreenNObjects={this.state.oWebScreenNObjects} oAndroidScreenNObjects={this.state.oAndroidScreenNObjects} oIosScreenNObjects={this.state.oIosScreenNObjects}
										oOtherMobileScreenNObjects={this.state.oOtherMobileScreenNObjects} OSName={this.state.osDropdownVal} pageName={this.state.pageDropdownVal}
										globalSearchCheckbox={this.state.globalSearchCheckbox}
									/>
								</div>
								<div className="ffTable">
									<CaseTable ShowCallToSteps={this.ShowCallToSteps} callToFeatures={this.state.callToFeatures} shouldUpdate={this.state.shouldCaseTableUpdate} delCase={this.delCase} testSteps={this.state.cases} actionNameVal={this.state.actionNameVal} actionChange={this.actionChange} actions={this.state.actions} />
								</div>
							</div>	
							{this.state.showSpinner ? <div className="loader"></div> : ""}
					</div>
					
				</div>
				
            )
        }
	}

	class OSPageSelector extends React.Component {
		render (){
			<div className="app-page-container">
				<div className="selBrowser">
					Select OS
					<Dropdown dval={this.state.osDropdownVal} type={"os"} items={this.state.os} change={this.OSChange} 
						disabledFlag={false} />
					
				</div>
				<div className="selPage"> 
					Select Page
					<Dropdown dval={this.state.pageDropdownVal} type={"page"} items={this.state.pagesDropdown} change={this.pageChange}
						disabledFlag={false} />
				</div>
			</div>
		}
	}
	class ManualORModule extends React.Component {
		render(){
			//console.log(this.props.renderSourceOption);
			if (this.props.renderSourceOption.toLowerCase() == "manual"){
				return (
					<div className="upload-sheets">
						<div>
							<div onClick={this.props.uploadORSheets} className="upload-or-button">
								<div className="upload-or"></div>
								<p className="upload-text">Import OR</p>
								<img src={"icons/xls-icon.png"} height="42" />
							</div>
						</div>
					</div>
				)
			}
			else {
				return null;
			}
		}
	}
	class GitlabModule extends React.Component {
		render(){
			if (this.props.renderSourceOption.toLowerCase() == "gitlab"){
				return (
					<div className="upload-sheets">
						<GitlabProjectName dval={this.props.gitlabProjectName} items={this.props.gitlabProjectsName} change={this.props.gitlabProjectChange} />
						<GitlabBranchtName dval={this.props.gitlabBranchName} items={this.props.projectBranches} change={this.props.gitlabBranchChange} />
					</div>
				)
			}
			else{
				return null;
			}
		}
	}
	
	class GitlabProjectName extends React.Component {
		render(){
			return (	
				<div className="selBrowser">
					Select Project Name
					<Dropdown dval={this.props.dval} type={"os"} items={this.props.items} change={this.props.change} 
						disabledFlag={false} />
				</div>
			)
		}
	}
	class GitlabBranchtName extends React.Component {
		render(){
			return (
				<div className="selBrowser">
					Select Project Branch
					<Dropdown dval={this.props.dval} type={"os"} items={this.props.items} change={this.props.change} 
						disabledFlag={false} />
					
				</div>
			)
		}
	}
    class LoadOR extends React.Component {
        constructor(props){
            super(props);
        
            this.handleORFileChange = this.handleORFileChange.bind(this);
            this.getSheetsName = this.getSheetsName.bind(this);
			this.showFileWindow = this.showFileWindow.bind(this);

        }
		componentDidMount(){

		}
        handleORFileChange (e) {
		
            var files = e.target.files;
            var ORStruct = {};
            var aStepsToAppend;
            var result;
            //console.log(this.props.test);
            for (let f = 0; f <= files.length - 1; f++){
               
				var file = files[f];
				var filePath = files[f].webkitRelativePath;
				var OSWEBType = filePath.indexOf('web/') >= 0 ? "web" : false;
				var OSMOBILEType = filePath.indexOf('mobile/') >= 0 ? "mobile" : false;
				var osName = "web";

				if (OSWEBType) {
					osName = OSWEBType;
				}
				else if (OSMOBILEType) {
					osName = OSMOBILEType;
				}

				if (filePath.indexOf('objectrepository/') >= 0) {
					this.getSheetsName(file, osName);
				}
            }
			//console.log("as;ldkfj;asldkfj;alksdfj;alksdjf;alksdjf;laksdjf;klasjd;flkj");
			document.getElementsByClassName("upload-done-message")[1].style.display = "block";
			this.props.stopSpinner();
			//console.log("display= " + document.querySelector(".upload-done-message").style.display);
        }

     
        getSheetsName(file, os){
            var reader = new FileReader();
			var _thisAppScope = this;
            var sFilename = file.name.split(".")[0];
			var sFilenameExtension = file.name.split(".")[1];
            var sOSName;
            var aStepsToAppend;

			var _this = this;

			reader.onload = function(e) {
                    var data = e.target.result;
                    var workbook = XLSX.read(data, {
                        type: 'binary'
                    });
                    workbook.SheetNames.forEach(function(sSheetName) {
                        // Here is your object
						var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sSheetName]);
						
                       // var json_object = JSON.stringify(XL_row_object);
						//console.log(json_object);
						/*var aofa = XLSX.utils.sheet_to_json(workbook.Sheets[sSheetName],  {header: 1}); 
						var wbook = XLSX.utils.book_new();
						var ws_data = aofa;
						var ws = XLSX.utils.aoa_to_sheet(ws_data);
						XLSX.utils.book_append_sheet(wbook, ws, 'sheet1');
						XLSX.writeFile(wbook, "joelitogarcia.xls");*/

						_this.props.updateor(sFilename, XL_row_object, os);
                    });

					//console.log("done");
                };
				
                reader.readAsBinaryString(file);
				
        }
		showFileWindow(){
			document.querySelector("#input-xls-select").click();
		}
		
		//closeImportScreen(){
			//document.querySelector("#import-container").style.display = "none";
			
		//}
        render(){
			if (this.props.bShowORImport){
				return (
					<div className="import-container-or">
						<span onClick={this.props.uploadORSheets} className="import-close">×</span>
						<div className="droppable">
							<h3 onClick={this.showFileWindow} className="choose-file" id="showfileselection" >Click to choose OR file(s)</h3>
							<b className="inline-element upload-done-message">Document uploaded successfully!</b>
						</div>
						<input className="input-xls-select" id="input-xls-select"  multiple type = "file" webkitdirectory="" onChange={this.handleORFileChange} />
						
					</div>
				);
			}
			else {
				return null;
			}
        }
    }


	class ImportScreenFF extends React.Component{
		//<CaseTable delCase={this.delCase} tableChilds={this.state.cases} actions={this.state.actions} />
		constructor(props){
			super(props);

			
			this.preventDefaults = this.preventDefaults.bind(this);

            
            this.chooseFileWindow = this.chooseFileWindow.bind(this);
            this.ExcelToJSON = this.ExcelToJSON.bind(this);
			this.getSheetsName = this.getSheetsName.bind(this);
			this.appendStepRows = this.appendStepRows.bind(this);
			this.closeImportScreen = this.closeImportScreen.bind(this);
			this.clearinput = this.clearinput.bind(this);
		}

		componentDidMount(){

        }
        
		
		preventDefaults (event) {
        	event.preventDefault(); event.stopPropagation();
		}
	
 
        chooseFileWindow(){
			var nativeuploadbtn = document.querySelector("#uploadXLSXInput");
			
            nativeuploadbtn.click();
            //document.querySelector(".upload-done-message").style.display = "none";
		}
	
        ExcelToJSON (e) { // handleFileChange
            var files = e.target.files;
            var ORStruct = {};

            for (let f = 0; f < files.length; f++){

                var file = files[f];
               // var sOSRead = file.toLowerCase().indexOf("android");
              //  var sOSName;

              //  if (sOSRead >= 0){
              //      sOSName = "android";
              //  }
               // else {
              //      sOSName = "ios";
               // }
            
                
                this.getSheetsName(file);
            }
			
			document.querySelector(".upload-done-message").style.display = "block";
            // var file = files[0];
            //e.target.value = '';
        }

        getSheetsName(file){
            var reader = new FileReader();
			var _thisAppScope = this;
            var sSheetName = file;
           // var sOSRead = file.toLowerCase().indexOf("android");
            var sOSName;
            var aStepsToAppend;

            //var ul = document.getElementById("sheet-list");
             //   ul.innerHTML = ""; 

                reader.onload = function(e) {
                    var data = e.target.result;//new Uint8Array(e.target.result);
                    var workbook = XLSX.read(data, { type: 'binary' }); //XLSX.read(data, { type: 'array' });
                    
                    workbook.SheetNames.forEach(function(sheet){
                        //var ul = document.getElementById("sheet-list");

                        
                        document.querySelector(".upload-done-message").style.display = "none";
                        aStepsToAppend = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);//XLSX.utils.sheet_to_json(workbook.Sheets[sheet], {header: 1});
						_thisAppScope.appendStepRows(aStepsToAppend);
						//console.log(aStepsToAppend);
                           // _thisAppScope.setState({                          })
                        //}
                       
                    });

                };

            reader.readAsBinaryString(file); //readAsArrayBuffer(file);
            return aStepsToAppend;
		}
		appendStepRows(aStepsToAppend){
				var aAvailableActions = this.props.availableActions;

				var sAvailableActions;
				for (let a=0; a < aAvailableActions.length; a++){
					sAvailableActions = sAvailableActions + "<option>" + aAvailableActions[a] + "</option>";
				}

                var oTable = document.querySelector('#toEx');

                var iActualRowsCount = oTable.rows.length;
                
                var iNewRowsCount = aStepsToAppend.length - 1;
                
                var iFinalRowsCount = iActualRowsCount + iNewRowsCount;// - 1;
                
                var oNewRow, oAction, oObject, oInput, oOutput, oComment, oDelete;
                var arrayIndexCounter = 0;

                for (let r = iActualRowsCount; r <= iFinalRowsCount; r++ ){

                    oNewRow = oTable.insertRow(r);
                
                    oAction = oNewRow.insertCell(0);
                    oObject = oNewRow.insertCell(1);
                    oInput = oNewRow.insertCell(2);
                    oOutput = oNewRow.insertCell(3);
					oComment = oNewRow.insertCell(4);
					oDelete = oNewRow.insertCell(5);

					var sAction = typeof(aStepsToAppend[arrayIndexCounter]["Action"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Action"];
						sAction = sAction.trim();

					var sActions = "<select>" + sAvailableActions + "</select>";//'<select><option>Input</option><option>Click</option><option>Verify</option><option>GetValue</option><option>NavigateTo</option><option>WaitFor</option><option>SetTableRow</option><option>Launch</option><option>Hover</option><option>Close</option></select>';
					
					if (sActions.indexOf(sAction) != -1){
						sActions = sActions.replace('<option>' + sAction + '</option>', '<option selected>' + sAction + '</option>')
						
					}
					else {
						sActions = '<select><option selected>' + sAction + '</option>' + sAvailableActions + '</select>';
					}
					oAction.innerHTML = sActions;
					
					oObject.className = "cases-objName-width";
                    oObject.innerText =typeof(aStepsToAppend[arrayIndexCounter]["Object"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Object"];
                    
                    var sinput = typeof(aStepsToAppend[arrayIndexCounter]["Input"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Input"];
				   // oInput.innerText = typeof(aStepsToAppend[arrayIndexCounter][2]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter][2];
				   	oInput.className = "action-input-width";
                    oInput.innerHTML = "<textarea>" + sinput + "</textarea>";

					var soutput = typeof(aStepsToAppend[arrayIndexCounter]["Output"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Output"];
					oOutput.className = "action-input-width";
                    oOutput.innerHTML = "<textarea>" + soutput + "</textarea>";

					var scomment = typeof(aStepsToAppend[arrayIndexCounter]["Comment"]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter]["Comment"];
					oComment.className = "action-input-width";
                    oComment.innerHTML = "<textarea>" + scomment + "</textarea>";

                   // oComment.innerText = typeof(aStepsToAppend[arrayIndexCounter][4]) == "undefined" ? "": aStepsToAppend[arrayIndexCounter][4];
				   oDelete.className="delCase"
				   oDelete.innerHTML = '<div class="close"> &times;</div>';
				   oDelete.onclick = function(obj){
					
						//console.log(obj.target.parentNode.parentNode.parentNode.parentNode);
						//console.log(obj.target.parentNode.parentNode.rowIndex);
						

						let iClickedRow = obj.target.parentNode.parentNode.rowIndex;					
						let oTableObj = obj.target.parentNode.parentNode.parentNode.parentNode;
							oTableObj.deleteRow(iClickedRow);
	
				   }

                   arrayIndexCounter++;

                }

                //if (r = iFinalRowsCount){
					
                    document.querySelector(".upload-done-message").style.display = "block";
                //}
			}

			closeImportScreen(){
				//var ul = document.getElementById("sheet-list");
               // 	ul.innerHTML = ""; 
				document.querySelector('.import-container').style.display = "none";
			}

			
			clearinput(e){
				//console.log(this.value);
			}
			
        render(){
			
            return (
				<div className="import-container">
					<span onClick={this.closeImportScreen} className="import-close">×</span>
                    <div id="droppable" draggable="true" className="droppable" onDragStart={this.dragFunction} onDrop={(e) => this.handleDrop(e)} onDragOver={() => this.highlightDragEnter()} onDragEnter={this.highlightDragEnter} onDragEnter={this.preventDefaults} onDragOver={this.preventDefaults} onDragLeave={this.preventDefaults} onDrop={this.preventDefaults} >
						<h3 onClick={this.chooseFileWindow} className="choose-file" id="showfileselection" >Click to choose a file</h3>
						
                        <b className="inline-element upload-done-message">Document uploaded successfully!</b>
                        <input  onChange={this.ExcelToJSON} className="uploadXLSXInput" type = "file" id = "uploadXLSXInput" />
                    </div>
                   
                </div>
            )
        }
	}
	class ExportConfirmation extends React.Component{
		//<CaseTable delCase={this.delCase} tableChilds={this.state.cases} actions={this.state.actions} />
			render(){
				return (
					<table id="toExport" className="tblCSS">
                    <thead>
                        <tr>
                            <th>Action</th><th>Object</th><th>Input</th><th>Output</th><th>Comment</th>
                        </tr>
                    </thead>
                    <tbody>
                        {this.props.actionsss}
                    </tbody>
                </table>
				)
			}
	}
    class Elements extends React.Component{
        render(){
			this.addCase = this.props.addCase;
            //console.log(this.props.tableChilds);
			let oAllElements = this.props.tableChilds;
			let iNumOfElem = this.props.tableChilds.length;
			let globalFilteredElements = this.props.globalFilteredElements;
			let oElement;
			let oElementsToDisplay = [];
			let oFrameChildObjects;
			let iFrameChOCount;
			let sFrameName;
			let sNameToAddCase;
			var iGlobalKeyCounter = 0;
			var aElementsInnerText=[];
			var globalSearch = this.props.globalSearchCheckbox;
			let OS_Name = this.props.OSName;
			let globalObjectsPerOS;

			//console.log("<Elements globalFilteredElements LENGTH: ", globalFilteredElements.length);

			if (globalSearch){

				switch (OS_Name.toLowerCase()){

					case "web":
						globalObjectsPerOS = this.props.oWebScreenNObjects;
						break;
					case "ios":
						globalObjectsPerOS = this.props.oIosScreenNObjects;
						break;
					case "android":
						globalObjectsPerOS = this.props.oAndroidScreenNObjects;
						break;
					case "other mobile pages":
						globalObjectsPerOS = this.props.oOtherMobileScreenNObjects;
						break;
				}

				let iPagesFound = globalFilteredElements.length;
				
				let aRepositoryKeys;
				let ObjectName, SelectorType, SelectorValue;

				for (let p = 0; p < iPagesFound; p++){
					
					oElementsToDisplay.push( //iGlobalKeyCounter
						<tr className="global-filter-page" key={globalFilteredElements[p].screenName + iGlobalKeyCounter + p}><td>{globalFilteredElements[p].screenName}</td></tr>
					);

					for (let o = 0; o < globalFilteredElements[p].objects.length; o++){
						aRepositoryKeys = Object.keys(globalFilteredElements[p].objects[o]);
						
						ObjectName = globalFilteredElements[p].objects[o][aRepositoryKeys[0]];
						//SelectorType = globalFilteredElements[p].objects[o][aRepositoryKeys[1]];
						SelectorValue = globalFilteredElements[p].objects[o][aRepositoryKeys[2]];

						/*
							Object Name: index #1
							Selector Type: index #2
							Selector Value: index #3
						*/

						
					
					// iGlobalKeyCounter+ 1 + `${p}` + `${o}`
						oElementsToDisplay.push(
							<tr key={p + o + iGlobalKeyCounter + ObjectName}>
								<td className="element-name-width">{ObjectName}<div className="toggable-selector-name"><hr />{SelectorValue}</div></td>
								<td><div className="addCase" onClick={() => this.addCase(globalFilteredElements[p].objects[o], globalFilteredElements[p].screenName)}>+</div></td>
							</tr>
						);
					}
					
					iGlobalKeyCounter+=2;	
				}
			}
			else {

				
				let aRepositoryKeys;
				let ObjectName, SelectorType, SelectorValue;

				/*
					Object Name: index #0
					Selector Type: index #1
					Selector Value: index #2
				*/

				for (let el=0; el < iNumOfElem; el++){
					
					aRepositoryKeys = Object.keys(oAllElements[el]);
					
					ObjectName = oAllElements[el][aRepositoryKeys[0]];
					//SelectorType = globalFilteredElements[p].objects[o][aRepositoryKeys[1]];
					SelectorValue = oAllElements[el][aRepositoryKeys[2]];

					iGlobalKeyCounter+=1

					
						//else {<td><div className="addCase" onClick={() => this.addCase(oAllElements[el])}>Add</div></td>
						if (oAllElements[el]["Value"] == null){
							oElementsToDisplay.push(
								<tr key={iGlobalKeyCounter}>
									<td className="element-name-width">{ObjectName}<div className="toggable-selector-name"><hr />{SelectorValue}</div></td>
									<td><div className="addCase" onClick={() => this.addCase(oAllElements[el])}>+</div></td>
								</tr>
							);	
						}
						else {
							oElementsToDisplay.push(
								<tr key={iGlobalKeyCounter}>
									<td className="element-name-width">{ObjectName}<hr />{oAllElements[el]["Value"]}<p></p><div className="toggable-selector-name">{SelectorValue}</div></td>
									<td><div className="addCase" onClick={() => this.addCase(oAllElements[el])}>+</div></td>
								</tr>
							);	
						}
							
					//	}
					//}
				}
			}
            return (
                <table id="elements-table" className="tblCSS">
                    <thead>
                        <tr>
                            <th>Element Name</th><th>Add</th>
                        </tr>
                    </thead>
                    <tbody>
						{this.props.xmlReadDone ? 
							<tr>
								<td>{"Add_empty_step"}</td>
								<td><div className="addCase" onClick={() => this.addCase("placeholder-step")}>+</div></td>
							</tr>
							: ""
						}
						
                        {oElementsToDisplay}
                    </tbody>
                </table>
            )
        }
    }
	class OSIcon extends React.Component {

		
		render(){
			let svg;
			if (this.props.OSName == 'android'){
				svg = <svg class="a" viewBox="0 0 24 24"><path d="M10.139 2.839a7.263 7.263 0 0 1 2.004-.268 7.28 7.28 0 0 1 1.973.26l.831-1.247a.75.75 0 1 1 1.248.832l-.675 1.013c1.397.836 2.217 2.2 2.337 3.714H6.43c.119-1.507.932-2.866 2.317-3.703l-.663-1.036a.75.75 0 1 1 1.263-.808l.762 1.19a.76.76 0 0 1 .031.053zM8.714 18H7.571c-.63 0-1.142-.512-1.142-1.143v-8.57h11.428v8.57c0 .631-.512 1.143-1.143 1.143h-1.143v2.857a1.143 1.143 0 0 1-2.285 0V18H11v2.857a1.143 1.143 0 0 1-2.286 0V18zm-3.428-3.428a1.143 1.143 0 0 1-2.286 0V9.429a1.143 1.143 0 0 1 2.286 0v5.143zm16 0a1.143 1.143 0 0 1-2.286 0V9.429a1.143 1.143 0 0 1 2.286 0v5.143zM9.857 5.77a.572.572 0 1 0 0-1.143.572.572 0 0 0 0 1.143zm4.572 0a.571.571 0 1 0 0-1.142.571.571 0 0 0 0 1.142z"></path></svg>;
			}
			else if (this.props.OSName == 'ios'){
				svg = <svg class="a" viewBox="0 0 24 24"><path d="M19.5 15.2c-.398.902-.602 1.402-1.2 2.198C17.5 18.602 16.5 20 15.103 20c-1.204 0-1.5-.8-3.102-.8-1.602 0-1.898.8-3.102.8-1.296 0-2.296-1.3-3.097-2.5-2.102-3.2-2.301-7-1-9 .898-1.398 2.398-2.3 3.8-2.3C10 6.2 10.899 7 12 7c1.102 0 1.8-.8 3.398-.8 1.204 0 2.5.698 3.5 1.8-3 1.7-2.5 6 .602 7.2zM14.3 4.897c.598-.796 1-1.796.9-2.898-1 .102-2.098.7-2.802 1.5-.597.7-1.097 1.8-.898 2.898 1 0 2.102-.699 2.8-1.5z"></path></svg>;
			}
			else {
				svg = <i>nadita</i>;
			}
			return (svg);
		}
	}
    class Dropdown extends React.Component {
        
        render() {
	
            this.change = this.props.change;
			
            let names = this.props.items.map((name, i) => 
                 <option key={i}>{name}</option>
            );
			names.unshift( <option key={"select"}>select</option> );
            return (
				<div> 
					<select value={this.props.dval} disabled={this.props.disabledFlag} onChange={this.change} >
						{names}
					</select>
					<p></p>
				</div>
            )
        }
	}

	class ShotCallToStepsModal extends React.Component {
		constructor(props){
			super(props);
			this.closeModal = this.closeModal.bind(this);
		}
		closeModal(){
			document.getElementById("callto-modal").style.display = 'none';
		}

		render (){
			return (
				<div id="callto-modal" className="callTo-modal">
					<div className="modal-content">
						
						<span id="modalClose" onClick={this.closeModal} className="modalClose">&times;</span>
						
						<table id="CallToStepsTable">
							<thead>
								<tr>
									<th>Action</th><th>Object</th><th>Input</th><th>Output</th><th>Comment</th>
								</tr>
                    		</thead>
                    		<tbody>
								<tr>
									<td>Row2 cell1</td>
									<td>Row2 cell2</td>
								</tr>
                    		</tbody>
						</table>
					</div>
				</div>
				
			);
		}
	}
	class Modal extends React.Component {
		constructor(props){
			super(props);

			this.state = {
				filename: "Feature File",
				sheetname: "Minor Feature",
			}
			this.onChange = this.onChange.bind(this);
			this.exportXLS = this.exportXLS.bind(this);
			this.closeModal = this.closeModal.bind(this);
		}
		closeModal(){
			document.getElementById("modal").style.display = 'none';
		}
		exportXLS(){
			//var filename = document.getElementById("ff-filename");//.value;
			
			//filename.value == "" ? filename.value : "Feature File Export";

			var htmlworksheet = XLSX.utils.table_to_sheet(document.getElementById("toExport"));
  
			var wb = XLSX.utils.book_new();

			XLSX.utils.book_append_sheet(wb, htmlworksheet, "Sheet1");

			XLSX.writeFile(wb, this.state.filename + ".xls");
			
		}

		onChange(event){
			if (event.target.name == "filename"){
				this.setState({
					filename: event.target.value
				});
			}
			else if (event.target.name == "sheetname"){
				this.setState({
					sheetname: event.target.value
				});
			}

		}
		render(){
			const gap = {
				margin: '2px',
			};

			const bubble = {
				borderRadius: '4px',
				backgroundColor: 'rgb(31, 126, 180)',
				padding: '2px',
				color: 'white'
			}
			const alert = {
				float: 'right',
				backgroundColor: 'orange',
				color: 'white',
				borderRadius: '4px',
				margin: '2px',
				padding: '3px'
			}
			return (
				<div id="modal" className="modal">
					<div className="modal-content">
						<i>{"Please confirm export "}</i>
						<span id="modalClose" onClick={this.closeModal} className="modalClose">&times;</span>
						<input onClick={this.exportXLS} id="exportNew" type="button" value="Export"/><br/>
						
						<div style={gap}>
							<span style={bubble}>File Name:</span><input onChange={this.onChange} name="filename" value={this.state.filename} style={gap} type="text" /><i>.xls</i>
							
						</div>
						<ExportConfirmation actionsss={this.props.actionsss} />
					</div>
				</div>
			)
		}
	}

	class FilterByElementsDropdown extends React.Component {
		
		render(){
			var aOptions = ["select", "text", "link", "button", "list", "input", "radio", "checkbox", "img", "table"];

			let hOptions = aOptions.map((elem, i) =>
				<option key={i}>{elem}</option>
			);
			return (
				<select value={this.props.sElementsFilter} data-type={"type"} onChange={this.props.handleFilterChange}>{hOptions}</select>
			);
		}
	}

	class TextArea extends React.Component {
		constructor(props) {
			super(props);
			// create a ref to store the textInput DOM element
			this.textInput = React.createRef();
			
		}
		componentDidMount() {
			//$("#autocomplete").autocomplete(...).data("autocomplete")._renderItem = function( ul, item) {
				//return $( "<li></li>" )
				//.data( "item.autocomplete", item )
				//.append( $( "<a></a>" ).html( item.label ) )
				//.appendTo( ul );
			//};
		}

		render(){

			let keyword = this.props.actionNameVal.toLowerCase(); //obj["Type"];//aSplitObjectName[1].toLowerCase();//obj.name.split("_")
			var tags=[];

			if (this.props.type == "input"){
				switch (keyword){

					case "Input".toLowerCase():
						tags = ["ON", "OFF", "text", "ByPartialText||dropdown-partial-text", "ByPartialText||dropdown-partial-text||partial-text-2"];
						break;

					case "InputIfExists".toLowerCase():
						tags  = ["time"];
						break;
					
					case "ClickIfExists".toLowerCase():
						tags  = ["time"];
						break;

					case "Verify".toLowerCase():
						tags  = ["Is|| ", "IsNot||", "Contains||", "DoesNotContain||", "Exists", "DoesNotExist", "TextEqual||", "Url||", "UrlContains||", "TitlePageIs||", "RowCount||", 
								"AttributeIs||attribute-name||expected-value", "AttributeIs||attribute-name||expected-value||row-number||column-number", 
								"AttributeIsNot||attribute-name||expected-value||row-number||column-number", "AttributeContains||attribute-name||expected-value||row-number||column-number", 
								"AttributeIsEmpty||attribute-name||row-number||column-number", "AttributeIsEmpty||attribute-name", "CssValueIs||attribute-name||expected-value"];
						//AttributeIsNot: tiene un bug. No está utilizando verificationValue y no está contemplando las tablas.
						break;
					case "SelectElement".toLowerCase():
						tags  = ["ByVisibleText||dropdown-text", "ByValue||dropdown-value-property", "ByIndex||dropdown-index-order"];
						break;

					case "SelectByIndex".toLowerCase():
						tags  = ["number-of-index -> note: first option starts with 0"];
						break;

					case "GetValue".toLowerCase():
						tags  = ["attribute-name"];
						break;
					case "NavigateTo".toLowerCase():
						tags  = ["url"];
						
						break;
					case "WaitFor".toLowerCase():
						tags = ["Implicit", "VisibilityOf||max-wait-time", "InvisibilityOf||max-wait-time", "ElementToBeClickable||max-wait-time", "ElementToBeSelected||max-wait-time", "AlertIsPresent||max-wait-time",
								"AlertIsPresent||max-wait-time", "FrameToBeAvailableandSwitchToIt||max-wait-time", "TextToBePresentInElement||max-wait-time||expected-text","TextToBePresentInElementLocated||max-wait-time||expected-text",
								"TextToBePresentInElementValue||max-wait-time||expected-value(value property...not the text)"];//["value || ", "Exists", "DoesNotExist"];
						break;
					case "SetTableRow".toLowerCase():
						tags = ["text-to-search", "text-1-to-search||text-n+1-to-search"];
						break;
					case "SwipeUpwards".toLowerCase():
						tags = ["leave-empty-for-50%-swipe", "0 - 100 % of swipe"];
						break;
					case "SwitchTab".toLowerCase():
						tags = ["Newtab", "number-of-tab"];
						break;
					case "SwitchFrame".toLowerCase():
						tags = ["frameID", "frame-number(zero is first)", "Active", "ActiveElement", "Parent", "ParentFrame", "Default", "DefaultContent"];
						break;
					case "DoMathOperations".toLowerCase():
						tags = ["math-operation"];
						break;
					case "CallTo".toLowerCase():
						//fetchthings
						//this.props.getCallTo();
						let callToNames = this.props.callToFeatures.map( e => {
							return e.name;
						});
						tags = callToNames;
						break;
					case "ClickInsideTable".toLowerCase():
						tags = ["HtmlTag||ElementText"];
						break;
					case "GetText".toLowerCase():
						tags = ["TableColumnNumber", "TableRowNumber||TableColumnNumber"];
						break;
					case "InputIfExistsAndPressEnter".toLowerCase():
						tags = ["text"];
						break;
						
				}
			}
			else if (this.props.type == "output"){
				switch (keyword){

					case "GetValue".toLowerCase():
						tags = ["<<output-variable>>"];
						break;
					case "DoMathOperations".toLowerCase():
						tags = ["<<output-variable>>"];
					break;
				}

			}

			var oTextAreaObj = this.textInput.current;
			
			$(oTextAreaObj).autocomplete({source: tags, minLength: 0}).focus(function(){$(this).autocomplete('search', $(this).val())});
			//$(oTextAreaObj).autocomplete({source: tags, autoFocus:true}).mouseenter().click();

			return (
				<td><textarea ref={this.textInput} className="action-input-width"></textarea></td>
			);
		}
	}
	class TR extends React.Component {
		//calldelCase(obj){
		//	props.delCase(obj.target.parentNode.parentNode.parentNode.rowIndex);
		//}
//<td><textarea className="action-input-width"></textarea></td>
//delCase = obj => {

		render(){
			//const props = this.props;
			//this.delCase = this.props.delCase;
			/*
			let sortedActions = this.props.actions.sort();
			sortedActions.unshift("Select");
			*/
			let actions = this.props.actions.map((action, i) =>
				<option key={i}>{action}</option>
			);

			let objectProps = this.props.object;
			let newValue = this.props.actionNameVal;

			//console.log("TR component called");//defaultValue={objectProps.text}
			if (objectProps.text == "placeholder-step"){
				return (
					<tr>
						<ActionsSelect ShowCallToSteps={this.props.ShowCallToSteps} actionChange={this.props.actionChange} actions={actions}/>
						<td><textarea className="action-input-width"></textarea></td>
						<TextArea callToFeatures={this.props.callToFeatures} type={"input"} objectProps={objectProps} actionNameVal={this.props.actionNameVal} />
						<td><textarea className="action-input-width"></textarea></td>
						<td><textarea className="action-input-width"></textarea></td>
						<td className="delCase">
							<div className="close" onClick={this.props.delCase}> &times;</div>
						</td>
					</tr>
				);
			}
			else if(objectProps.text == "add-page"){
				return (
					<tr>
						<td><select>{actions}</select></td>
						<td  className="cases-objName-width">{objectProps.pageName}</td>
						<td><textarea className="action-input-width"></textarea></td>
						<td><textarea className="action-input-width"></textarea></td>
						<td><textarea className="action-input-width"></textarea></td>
						<td className="delCase">
							<div className="close" onClick={this.props.delCase}> &times;</div>
						</td>
					</tr>
				);
			}
			else {
				return (
					<tr>
						<ActionsSelect ShowCallToSteps={this.props.ShowCallToSteps} actionChange={this.props.actionChange} actions={actions}/>
						<td className="cases-objName-width"><div>{objectProps.pageName + "|" + objectProps["Object Name"]}</div></td>
						<TextArea callToFeatures={this.props.callToFeatures} type={"input"} objectProps={objectProps} actionNameVal={this.props.actionNameVal} />
						<TextArea callToFeatures={this.props.callToFeatures} type={"output"} objectProps={objectProps} actionNameVal={this.props.actionNameVal} />
						<td><textarea className="action-input-width"></textarea></td>
						<td className="delCase">
							<div className="close" onClick={this.props.delCase}> &times;</div>
						</td>
					</tr>
				);
			}
		}
	}
	class ActionsSelect extends React.Component {
		constructor(props){
			super(props);

			this.state = {
				showCallToStepsButton: false
				
			}
			this.processActionChange = this.processActionChange.bind(this);
			this.showSteps = this.showSteps.bind(this);
		}

		processActionChange(e){
			//alert("now and then");
			if (e.target.value == "CallTo"){
				var row = e.target.parentNode.parentNode.rowIndex;

				this.setState({
					showCallToStepsButton: true
				})
			}
			else {
				this.setState({
					showCallToStepsButton: false
				})
			}
			this.props.actionChange(e);	
		}
		showSteps(e){
			var row = e.target.parentNode.parentNode.rowIndex;
			this.props.ShowCallToSteps(row);
		}
		render() {
			
			//<select onChange={this.props.actionChange}>{actions}</select>
			//<ActionsSelect onChange={this.props.actionChange} actions={actions}/>
			if (this.state.showCallToStepsButton){
				return (
					<td>
						<select onChange={this.processActionChange}>{this.props.actions}</select>
						<input type="button" value="Show CallTo Steps" onClick={this.showSteps} />
					</td>
				)
			}
			else {
				return (
					<td><select onChange={this.processActionChange}>{this.props.actions}</select></td>
				)
			}
		}
	}
	class CaseTable extends React.Component{
		componentDidMount(){
			$("#toEx tbody").sortable();
		}
		//value = {this.props.actionNameVal}
//https://stackoverflow.com/questions/8238407/how-to-parse-excel-file-in-javascript-html5 
/*
<tr>
<td><select>{actions}</select></td>
<td></td>
<td><textarea className="action-input-width"></textarea></td>
<td></td><td><textarea className="action-input-width"></textarea></td>
<td className="delCase">
	<div className="close" onClick={this.props.delCase}> &times;</div>
</td>
</tr>
*/
        render(){
			//console.log("Case component called");
			//this.delCase = this.props.delCase; 
            //console.log(this.props.tableChilds);
			//let sortedActions = this.props.actions.sort();
			//sortedActions.unshift("Select");
			
		//	let actions = sortedActions.map((e, i) =>{
				//if (e=="Launch"){
				//	return <option selected key={i}>{e}</option>
				//}
				//else{
			//		return <option key={i}>{e}</option>
				//}
			//});
			
            let toDisplay = this.props.testSteps.map((element, i) => 			
		   		<TR ShowCallToSteps={this.props.ShowCallToSteps} callToFeatures={this.props.callToFeatures} delCase={this.props.delCase} object={element} actions={this.props.actions} key={i} actionNameVal={this.props.actionNameVal} actionChange={this.props.actionChange} />
			);
            return (
                <table  id="toEx">
                    <thead>
                        <tr>
                            <th>Action</th><th>Object</th><th>Input</th><th>Output</th><th>Comment</th><th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
						
						{toDisplay}

                    </tbody>
                </table>
            )
        }
    }

      ReactDOM.render(
        <App />,
        document.getElementById('root')
      );

	</script>
  </body>
</html>
